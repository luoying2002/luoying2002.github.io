
  <!DOCTYPE html>
  <html lang="zh-CN"  >
  <head>
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_tq6stt6tcg';window.REIMU_CONFIG.clipboard_tips = {"success":"复制成功(*^▽^*)","fail":"复制失败 (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！"}};window.REIMU_CONFIG.outdate = {"enable":true,"daysAgo":730,"message":"本文最后更新于 {time}，请注意文中内容可能已经发生变化。"};window.REIMU_CONFIG.code_block = {"expand":30};</script>
  
  <title>
    Nucleotide-Transformer：构建和评估人类基因组学的稳健基础模型 |
    
    小小白的笔记屋
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CJetBrains%20Mono:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CJetBrains%20Mono:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_tq6stt6tcg.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="文章链接  Dalla-Torre, H., Gonzalez, L., Mendoza-Revilla, J. et al. Nucleotide Transformer: building and evaluating robust foundation models for human genomics. Nat Methods (2024).  https:&#x2F;&#x2F;doi.org&#x2F;10.10">
<meta property="og:type" content="article">
<meta property="og:title" content="Nucleotide-Transformer：构建和评估人类基因组学的稳健基础模型">
<meta property="og:url" content="https://luoying.netlify.app/2024/11/17/4x6a3fgp/index.html">
<meta property="og:site_name" content="小小白的笔记屋">
<meta property="og:description" content="文章链接  Dalla-Torre, H., Gonzalez, L., Mendoza-Revilla, J. et al. Nucleotide Transformer: building and evaluating robust foundation models for human genomics. Nat Methods (2024).  https:&#x2F;&#x2F;doi.org&#x2F;10.10">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luoying.netlify.app/images/assets//image-20241216164728681.png">
<meta property="og:image" content="https://luoying.netlify.app/images/assets//image-20241216164810595.png">
<meta property="og:image" content="https://luoying.netlify.app/images/assets//image-20241216164914266.png">
<meta property="og:image" content="https://luoying.netlify.app/images/banner.webp">
<meta property="og:image" content="https://luoying.netlify.app/images/assets//image-20241216164949510.png">
<meta property="og:image" content="https://luoying.netlify.app/images/assets//image-20241216165021903.png">
<meta property="og:image" content="https://luoying.netlify.app/images/banner.webp">
<meta property="article:published_time" content="2024-11-17T15:28:45.000Z">
<meta property="article:modified_time" content="2025-10-01T10:48:10.452Z">
<meta property="article:author" content="LuoYing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luoying.netlify.app/images/assets//image-20241216164728681.png">
  
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
    
      
        
<link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.11/dist/katex.min.css">

      
    
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css">

  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">小小白祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/">首页</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/archives">归档</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/about">关于</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/friend">友链</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
  </nav>
</div>
<header id="header">
  
    
      <img fetchpriority="high" src="/images/banner.webp" alt="Nucleotide-Transformer：构建和评估人类基因组学的稳健基础模型">
    
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">Nucleotide-Transformer：构建和评估人类基因组学的稳健基础模型</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content">
          
            <aside id="sidebar">
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5"><span class="toc-number">1.</span> <span class="toc-text"> 文章链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text"> 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">3.</span> <span class="toc-text"> 摘要</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E6%96%B0%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text"> 创新点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9"><span class="toc-number">5.</span> <span class="toc-text"> 主要内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%89%8D%E9%A1%BB%E7%9F%A5"><span class="toc-number">5.1.</span> <span class="toc-text"> 读前须知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">5.2.</span> <span class="toc-text"> 引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">5.3.</span> <span class="toc-text"> 结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nucleotide-transformer%E6%A8%A1%E5%9E%8B%E5%87%86%E7%A1%AE%E9%A2%84%E6%B5%8B%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.3.1.</span> <span class="toc-text"> Nucleotide Transformer模型准确预测基因组学任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95"><span class="toc-number">5.3.2.</span> <span class="toc-text"> 基因组学基础模型的基准测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E6%97%A0%E7%9B%91%E7%9D%A3%E7%9A%84%E6%96%B9%E5%BC%8F%E6%A3%80%E6%B5%8B%E5%B7%B2%E7%9F%A5%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%83%E4%BB%B6"><span class="toc-number">5.3.3.</span> <span class="toc-text"> 以无监督的方式检测已知的基因组元件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E8%AE%AD%E7%BB%83%E7%9A%84%E5%B5%8C%E5%85%A5%E9%A2%84%E6%B5%8B%E7%AA%81%E5%8F%98%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">5.3.4.</span> <span class="toc-text"> 预训练的嵌入预测突变的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E4%B8%AD%E6%88%90%E6%9C%AC%E6%95%88%E7%9B%8A%E9%A2%84%E6%B5%8B%E7%9A%84%E6%A8%A1%E5%9E%8B%E4%BC%98%E5%8C%96"><span class="toc-number">5.3.5.</span> <span class="toc-text"> 基因组学中成本效益预测的模型优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A8%E8%AE%BA"><span class="toc-number">5.4.</span> <span class="toc-text"> 讨论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">5.5.</span> <span class="toc-text"> 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.5.1.</span> <span class="toc-text"> 模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">5.5.1.1.</span> <span class="toc-text"> 架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83"><span class="toc-number">5.5.1.2.</span> <span class="toc-text"> 训练</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B"><span class="toc-number">5.5.1.3.</span> <span class="toc-text"> 探测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83"><span class="toc-number">5.5.1.4.</span> <span class="toc-text"> 微调</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E7%9B%91%E7%9D%A3bpnet%E5%9F%BA%E7%BA%BF%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">5.5.1.5.</span> <span class="toc-text"> 与监督BPNet基线的比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E5%B7%B2%E5%8F%91%E5%B8%83%E7%9A%84%E9%A2%84%E8%AE%AD%E7%BB%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">5.5.1.6.</span> <span class="toc-text"> 与已发布的预训练基因组学模型的比较</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.</span> <span class="toc-text"> 预训练数据集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%BA%E7%B1%BB%E5%8F%82%E8%80%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.1.</span> <span class="toc-text"> 人类参考基因组数据集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%83%E4%BA%BA%E5%9F%BA%E5%9B%A0%E7%BB%841000g%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.2.</span> <span class="toc-text"> 千人基因组(1000G)数据集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E7%89%A9%E7%A7%8D%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.3.</span> <span class="toc-text"> 多物种数据集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">5.5.3.</span> <span class="toc-text"> 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E8%AE%BE%E6%96%BD"><span class="toc-number">5.5.3.1.</span> <span class="toc-text"> 硬件设施</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nucleotide-transformer%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.5.4.</span> <span class="toc-text"> Nucleotide Transformer下游任务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E8%A7%82%E9%81%97%E4%BC%A0%E6%A0%87%E8%AE%B0%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.1.</span> <span class="toc-text"> 表观遗传标记预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%AD%90%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.2.</span> <span class="toc-text"> 启动子序列预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA%E5%AD%90%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.3.</span> <span class="toc-text"> 增强子序列预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%AA%E6%8E%A5%E4%BD%8D%E7%82%B9%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.4.</span> <span class="toc-text"> 剪接位点预测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E5%89%B2%E5%92%8C%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0"><span class="toc-number">5.5.5.</span> <span class="toc-text"> 数据集分割和性能评估</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.5.6.</span> <span class="toc-text"> 其他下游任务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%93%E8%89%B2%E8%B4%A8%E8%B0%B1%E7%B3%BB%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.6.1.</span> <span class="toc-text"> 染色质谱系预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spliceai%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95"><span class="toc-number">5.5.6.2.</span> <span class="toc-text"> SpliceAI基准测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA%E5%AD%90%E6%B4%BB%E6%80%A7%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.6.3.</span> <span class="toc-text"> 增强子活性预测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">5.5.7.</span> <span class="toc-text"> 其他性能分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#t-sne%E5%B5%8C%E5%85%A5%E6%8A%95%E5%BD%B1"><span class="toc-number">5.5.7.1.</span> <span class="toc-text"> t-SNE嵌入投影</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E6%9E%84%E5%87%86%E7%A1%AE%E7%8E%87%E5%92%8C%E5%A4%8D%E6%9D%82%E5%BA%A6perplexity"><span class="toc-number">5.5.7.2.</span> <span class="toc-text"> 重构准确率和复杂度（perplexity）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%83%E7%B4%A0%E4%B8%AD%E7%9A%84%E6%A0%87%E8%AE%B0%E9%87%8D%E6%9E%84"><span class="toc-number">5.5.7.3.</span> <span class="toc-text"> 不同基因组元素中的标记重构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%8F%98%E5%BC%82%E4%BC%98%E5%85%88%E7%BA%A7%E6%8E%92%E5%BA%8F"><span class="toc-number">5.5.7.4.</span> <span class="toc-text"> 功能变异优先级排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%8A%9B%E5%9B%BE%E5%88%86%E6%9E%90"><span class="toc-number">5.5.7.5.</span> <span class="toc-text"> 注意力图分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E6%B5%8Bdeepstarr%E6%95%B0%E6%8D%AE%E4%B8%AD%E9%87%8D%E8%A6%81%E7%9A%84tf%E5%9F%BA%E5%BA%8F%E5%AE%9E%E4%BE%8B"><span class="toc-number">5.5.7.6.</span> <span class="toc-text"> 预测DeepSTARR数据中重要的TF基序实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">5.5.8.</span> <span class="toc-text"> 数据可用性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">5.5.9.</span> <span class="toc-text"> 代码可用性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E4%BF%A1%E6%81%AF"><span class="toc-number">6.</span> <span class="toc-text"> 补充信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">7.</span> <span class="toc-text"> 参考文献</span></a></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="LuoYing" class="lazyload">
  <div class="sidebar-author-name">LuoYing</div>
  <div class="sidebar-description">一方小筑，与君共勉</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">119</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">15</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">2</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  
</aside>

          
          <section id="main"><article id="post-4x6a3fgp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2024/11/17/4x6a3fgp/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2024-11-17T15:28:45.000Z" itemprop="datePublished">2024-11-17</time>
    <time style="display: none;" id="post-update-time">2025-10-01</time>
  </a>
</div>

      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" data-aos="zoom-in">论文解读</a>
  </div>


    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote id="outdate-blockquote" style="display: none;"><p></p></blockquote>
      
      
        <h1 id="文章链接"><a class="markdownIt-Anchor" href="#文章链接"></a> 文章链接</h1>
<blockquote>
<p>Dalla-Torre, H., Gonzalez, L., Mendoza-Revilla, J. et al. Nucleotide Transformer: building and evaluating robust foundation models for human genomics. Nat Methods (2024).  <a target="_blank" rel="noopener" href="https://doi.org/10.1038/s41592-024-02523-z">https://doi.org/10.1038/s41592-024-02523-z</a></p>
</blockquote>
<h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1>
<p><code>Nucleotide Transformer</code>：提出了一个构建和评估人类<code>基因组学</code>的稳健基础模型</p>
<h1 id="摘要"><a class="markdownIt-Anchor" href="#摘要"></a> 摘要</h1>
<p>从DNA序列<code>预测分子表型</code>一直是基因组学中的一个长期挑战，这主要受限于标注数据的数量以及在不同任务间迁移学习的困难。在此，我们展示了一项关于在DNA序列上预训练的基础模型（称为<code>Nucleotide Transformer</code>）的广泛研究。这些模型参数规模从<code>5000万</code>到<code>25亿</code>不等，整合了来自<code>3,202</code>个人类基因组和<code>850</code>个不同物种基因组的信息。这些转换器模型能够产生特定上下文的核苷酸序列表征，使其即使在低数据量情况下也能进行准确预测。我们展示了这些开发的模型可以以低成本微调来解决各种基因组学应用。尽管没有监督，这些模型学会了将注意力集中在关键基因组元件上，并可用于改进<code>遗传变异</code>的优先级排序。在基因组学中训练和应用基础模型为从DNA序列进行准确的分子表型预测提供了一种广泛适用的方法。</p>
<blockquote>
<p><code>分子表型</code>：基因表达在分子水平上的具体体现，包括细胞内的蛋白质、RNA、代谢物等分子及其相互作用网络所呈现的可测量特征，它是连接基因型和传统表型的桥梁，帮助我们理解基因如何通过分子机制影响生物体的性状表现。</p>
</blockquote>
<h1 id="创新点"><a class="markdownIt-Anchor" href="#创新点"></a> 创新点</h1>
<ol>
<li><strong>规模和多样性的突破</strong>：</li>
</ol>
<ul>
<li>构建了迄今为止最大的<code>DNA基础模型</code>之一，参数规模达到<code>25亿</code></li>
<li>使用了迄今最大规模和最多样化的训练数据集，包含<code>3,202</code>个人类基因组和<code>850</code>个不同物种的基因组数据</li>
</ul>
<ol start="2">
<li><strong>技术创新</strong>：</li>
</ol>
<ul>
<li>提出了<code>NT-v2</code>优化版本，通过架构改进实现了模型小型化（参数减少<code>50</code>倍）的同时保持或提升性能</li>
<li>创新性地采用了参数高效的微调技术（<code>IA3</code>），仅需调整<code>0.1%</code>的参数就能实现高性能</li>
</ul>
<ol start="3">
<li><strong>应用创新</strong>：</li>
</ol>
<ul>
<li>无需监督即可识别关键基因组元素</li>
<li>提出了基于<code>零样本</code>的遗传变异评分方法</li>
<li>在多个具有挑战性的基因组学任务上达到或超过了专门设计的监督学习模型的性能</li>
</ul>
<h1 id="主要内容"><a class="markdownIt-Anchor" href="#主要内容"></a> 主要内容</h1>
<h2 id="读前须知"><a class="markdownIt-Anchor" href="#读前须知"></a> 读前须知</h2>
<ol>
<li>论文解读尽可能的还原原文，若有不恰当之处，还请见谅；</li>
<li>排版上，插图会尽量贴近出处，而<code>补充图表</code>均在文末“<code>补充信息</code>”的下载链接中；</li>
<li>左边👈有目录，可自行跳转至想看的部分；</li>
<li>部分专业术语翻译成中文可能不太恰当，此时会用括号标明它的英文原文，如感受野（<code>Receptive field</code>）。请注意，仅首次出现会标明；</li>
</ol>
<h2 id="引言"><a class="markdownIt-Anchor" href="#引言"></a> 引言</h2>
<p><code>人工智能</code>(AI)中的基础模型的特点是其大规模性质，包含数百万经过大量数据集训练的参数。这些模型可以适应广泛的后续预测任务，并且已经深刻地改变了AI领域。自然语言处理(NLP)中的著名例子包括所谓的语言模型(LM)<code>BERT</code>和<code>GPT</code>。近年来LM变得越来越受欢迎，这要归功于它们能够在<code>未标记的数据</code>上进行训练，从而创建能够解决下游任务的通用表示。它们实现全面语言理解的一个方法是通过解决数十亿次完形测试，在这些测试中它们预测给定句子中空白处的正确单词。这种方法被称为掩码语言建模。</p>
<blockquote>
<p><code>掩码</code>：深度学习中是一种二进制标记机制，通常用0和1表示需要忽略或保留的数据。它可以用于处理缺失值、控制注意力机制的关注范围、实现序列填充对齐等任务。在Transformer中，掩码尤其重要，它既可以防止模型在预测时看到未来信息(自回归掩码)，也可以帮助处理不等长序列(填充掩码)。</p>
</blockquote>
<p>早期将这一目标应用于生物学的<code>基础模型</code>涉及在<code>蛋白质序列</code>上训练LM，它们的任务是在大型蛋白质序列数据集中预测被掩码的氨基酸。这些蛋白质LM在应用于下游任务时通过迁移学习，展示了与之前的方法竞争甚至超越之前方法的能力，例如预测蛋白质结构和功能，即使在数据稀缺的情况下也是如此。</p>
<p>除了蛋白质序列之外，<code>DNA序列</code>中编码的依赖模式在理解基因组过程中起着基础性作用，从表征调控区域到评估单个变异在其单倍型环境中的影响。在这种情况下，专门的深度学习(DL)模型已经被训练来揭示DNA中有意义的模式。例如，DL模型已被用于从DNA序列预测基因表达，最近的进展将卷积神经网络和<code>transformer架构</code>相结合，能够编码位于上游<code>100</code>千碱基(kb)的调控元件。</p>
<p>现代基因组学研究产生的大量数据既是机遇也是挑战。一方面，物种和群体之间的自然变异复杂模式可以轻易获得；另一方面，需要强大的DL方法来处理大规模数据，以便从未标记的数据集中准确提取信号。在基因组学中训练的大型基础模型似乎是值得探索的方法来应对这一挑战。</p>
<p>在这里，我们构建了用于编码基因组序列的<code>稳健基础模型</code>，称为<code>Nucleotide Transformer</code>(NT)，并提供了系统性研究和基准测试来评估其性能。我们通过构建四个不同大小的LM开始研究，从<code>5亿</code>到<code>25亿</code>参数不等。这些模型在三个不同数据集上进行预训练，包括人类参考基因组、<code>3,202</code>个多样化人类基因组的集合，以及来自各种物种的<code>850</code>个基因组。</p>
<p>训练之后，我们以两种方式利用每个模型的表示(嵌入)。为了评估<code>NT</code>在适应各种任务时的性能稳定性，我们在一组18个精选的基因组预测任务上训练了每个模型，并将它们与三个替代的<code>DNA基础模型</code>以及一个最先进的非基础模型进行比较，使用系统的<code>十折交叉验证</code>程序。</p>
<blockquote>
<p><code>十折交叉验证</code>：一种数据集划分方法，将数据集平均分成10份，每次用9份作为训练集，剩下1份作为验证集，轮流进行10次，最终取10次评估结果的平均值作为模型性能的估计。</p>
</blockquote>
<p>此外，为了扩大我们的评估，我们将我们表现最好的模型与三个针对特定任务优化的最先进的监督基线模型进行了比较。为了破译在预训练期间学习的序列特征，我们探索了模型的注意力图和复杂度（<code>perplexity</code>），并对其嵌入进行了数据降维。</p>
<p>此外，我们还评估了嵌入对人类功能重要遗传变异影响进行建模的能力，通过零样本评分。基于初始实验的发现，我们开发了第二组四个<code>LM</code>，参数从<code>5亿</code>减少到<code>5千万</code>，以研究这类模型的缩放规律。我们成功构建了一个模型，仅用十分之一的参数就达到了之前最佳模型的性能，同时将感受野大小翻了一番。</p>
<blockquote>
<p><code>感受野</code>：神经网络中某一层的神经元能够&quot;看到&quot;的输入区域范围。</p>
</blockquote>
<h2 id="结果"><a class="markdownIt-Anchor" href="#结果"></a> 结果</h2>
<h3 id="nucleotide-transformer模型准确预测基因组学任务"><a class="markdownIt-Anchor" href="#nucleotide-transformer模型准确预测基因组学任务"></a> <code>Nucleotide Transformer</code>模型准确预测基因组学任务</h3>
<p>我们开发了一系列基于<code>transformer</code>的DNA语言模型(NT)，它们从<code>6</code>kb未注释的基因组数据中学习了通用的核苷酸序列表示（图1a和方法）。受<code>NLP</code>中的趋势启发，即更大的训练数据集和模型规模已经显示出改进的性能，我们构建了具有不同参数规模和数据集的<code>transformer模型</code>：</p>
<ol>
<li>
<p>在人类参考基因组序列上训练的<code>5亿</code>参数模型（&quot;<code>Human ref 500M</code>&quot;）</p>
</li>
<li>
<p>一个<code>5亿</code>参数模型（&quot;<code>1000G 500M</code>&quot;）</p>
</li>
<li>
<p>一个<code>25亿</code>参数模型（&quot;<code>1000G 2.5B</code>&quot;）（它们都在<code>3,202</code>个遗传多样性的人类基因组上训练）</p>
</li>
<li>
<p>一个<code>25亿</code>参数模型，包含来自不同门类的<code>850</code>个物种（&quot;<code>Multispecies 2.5B</code>&quot;），其中包括11个模式生物（图1c和补充表1-4）。</p>
</li>
</ol>
<p><img src="/images/assets//image-20241216164728681.png" alt="image-20241216164728681" /></p>
<p>为了评估这些模型在预测各种<code>分子表型</code>方面的效果，我们从公开可获得的资源中整理了18个基因组数据集，包括剪接位点预测任务（<code>GENCODE</code>）、启动子任务（<code>Eukaryotic Promoter Database</code>）以及组蛋白修饰和增强子任务（<code>ENCODE</code>），每个数据集的大小都经过合理设计，以实现快速和严格的交叉验证程序（图1d，补充表5和方法）。</p>
<p>虽然对监督模型来说有更大的数据集可用，但这18个基因组数据集的编译提供了<code>多样化</code>和<code>稳健</code>的选择，用于严格检验模型在各种任务中的适应性，并与其他DNA自监督基础模型进行比较。这些数据集被处理成<code>标准化格式</code>以方便实验并确保在评估大型语言模型性能时的可重复性（方法）。我们通过两种不同的技术评估了我们的<code>transformer模型</code>：探测和微调（图1b）。</p>
<p><strong>探测</strong>是指使用学习到的语言模型DNA序列嵌入作为输入特征，输入到更简单的模型中来预测基因组标签。具体来说，我们使用逻辑回归或一个最多包含两个隐藏层的小型多层感知器(MLP)，探测了语言模型的十个任意选择的层。在<strong>微调</strong>的情况下，语言模型的头部被替换为分类或回归头部，并使用参数高效的技术进行再训练（方法）。为了确保不同模型之间的公平和准确比较，我们实施了<code>十折交叉验证</code>策略。</p>
<p>为了将我们的预训练基础模型方案与该领域的标准监督方法进行比较，我们从头开始在18个任务中的每一个上训练了不同版本的<code>BPNet</code>卷积架构（方法）。<code>BPNet</code>架构在基因组学中得到了广泛应用，代表了一个非常强大的默认架构，用于通过监督学习从头开始建模小型数据集。我们观察到原始<code>BPNet</code>模型在各个任务中都表现出强劲的性能（平均<code>Matthews</code>相关系数(MCC)为<code>0.665</code>），通过将其规模增加到<code>2800万</code>参数，我们可以将其提高（平均MCC为<code>0.683</code>），这证实了直接监督的卷积架构在基因组学任务中表现得非常好（图2a，b）。接下来，我们评估了<code>NT模型</code>的<code>探测</code>和<code>微调</code>与我们基准数据集上的这些监督基线模型相比如何。如果所得的两个标准差重叠或优于报告的基线值，我们认为这些模型是等同于或优于其他模型的。</p>
<blockquote>
<p><code>BPNet</code>：一个用于预测<code>DNA序列与蛋白质结合</code>的深度学习架构，它结合了扩张卷积网络和基于峰值的损失函数。该网络首先使用多尺度的扩张卷积来捕获DNA序列特征，然后通过解码器预测结合位点的概率分布，最后采用特殊的损失函数来优化对结合峰值的预测。<code>BPNet</code>的一个重要特点是可以生成<code>序列重要性分数</code>，帮助解释模型的<code>预测结果</code>。</p>
</blockquote>
<p>使用这个标准，<code>NT模型</code>仅通过<code>探测</code>就在5个任务中匹配基线<code>BPNet</code>模型，并在18个任务中的8个任务中超越了它们（补充图1和补充表6），并显著优于来自原始标记的探测。与最近的工作一致，我们观察到最佳性能既取决于模型也取决于层（补充表8）。我们还注意到，最高的模型性能从来不是通过使用最后一层的嵌入获得的，这与早期工作一致。例如，在增强子类型预测任务中，我们观察到性能最高和最低的层之间的相对差异高达<code>38%</code>，表明在各层之间学习到的表示有显著差异（补充图3）。与我们的探测策略相比，我们的微调模型在18个基线模型中要么匹配（n=6）要么超越（n=12）（图2a，b和补充表7和9）。值得注意的是，微调的NT模型优于探测模型，而且更大和更多样化的模型持续优于较小的模型。这些结果支持了有必要针对特定任务微调<code>NT基础模型</code>以实现更好的性能。</p>
<p>我们的结果还表明，在多样化数据集上训练的<code>Multispecies 2.5B</code>模型在几个基于人类测试的任务上优于或匹配<code>1000G 2.5B</code>模型（图2a，b）。这意味着增加序列多样性的策略，而不仅仅是增加模型规模，可能会带来更好的预测性能，特别是在计算资源有限的情况下。</p>
<p><img src="/images/assets//image-20241216164810595.png" alt="image-20241216164810595" /></p>
<p><code>微调</code>在之前的工作中没有被广泛探索，可能是由于其计算需求较高。我们通过采用最新的参数高效微调技术克服了这一限制，该技术仅需要总模型参数的<code>0.1%</code>（图1b和方法）。这种方法允许在<code>单个GPU</code>上更快地进行微调，比所有微调参数减少了<code>1,000</code>倍的存储需求，同时仍能提供相当的性能。在实践中，我们观察到即使使用简单的下游模型对嵌入进行探测，严格的探测也比微调更慢且计算强度更大。这种差异源于诸如层的选择、下游模型选择和超参数对性能的重要影响。此外，微调表现出更小的性能方差，增强了该方法的稳健性。总的来说，这种通用方法是多功能的，无需调整模型架构或超参数即可适应各种任务。这与监督模型形成鲜明对比，后者通常具有不同的架构，并且需要为每个任务从头开始训练。</p>
<p>最后，我们旨在评估<code>大型DNA语言模型</code>与使用大量数据集训练并优化架构的稳健基线进行竞争的潜力。为此，我们将<code>Multispecies 2.5B</code>模型应用于另外三个基因组预测任务，这些任务包括：</p>
<ol>
<li><strong>对来自多样化人类细胞和组织的<code>919</code>个染色质谱的分类</strong></li>
<li><strong>预测整个人类基因组中的规范剪接受体和供体位点</strong></li>
<li><strong>预测来自果蝇<code>S2</code>细胞的发育和管家增强子活性（见方法）</strong></li>
</ol>
<blockquote>
<p><code>剪接位点</code>：真核生物基因中内含子和外显子连接处的特定序列，主要包括5’剪接位点(供体位点)和3’剪接位点(受体位点)。在RNA前体剪接过程中，剪接体通过识别这些保守序列位点来确定剪接位置，将内含子去除并将外显子连接起来。准确的剪接位点识别对于<code>正确的基因表达和蛋白质合成</code>至关重要。</p>
</blockquote>
<p>值得注意的是，尽管没有对其原始微调架构进行额外的更改或优化，<code>Multispecies 2.5B</code>模型达到了与专门化<code>DL模型</code>紧密一致的性能水平。例如，在分类染色质特征谱的情况下，我们获得的曲线下面积(<code>AUC</code>)值平均仅比<code>DeepSEA</code>实现的值低约<code>~1%</code>（图2c）。</p>
<p>关于预测<code>pre-mRNA</code>转录本中的每个位置是否是剪接供体、剪接受体或都不是，我们调整了NT模型以提供核苷酸级别的剪接位点预测，并实现了<code>95%</code>的<code>top-k</code>准确率和<code>0.98</code>的精确率-召回率<code>AUC</code>（图2d）。值得注意的是，我们的<code>2.5B</code> <code>6-kb</code>上下文模型与最先进的<code>SpliceAI-10k</code>的性能相匹配，后者在<code>15-kb</code>输入序列上训练，此外还优于其他剪接基线；并且在测试<code>6-kb</code>输入序列时优于<code>SpliceAI</code>。</p>
<p>最后，在管家和发育增强子预测的情况下，我们的模型略微超过（<code>1%</code>）和获得较低（<code>4%</code>）的相关值（图2e），与<code>DeepSTARR</code>相比。在这三个不同任务中，我们还对我们的参数<code>高效微调</code>和<code>全模型微调</code>（训练模型的所有参数以优化其在特定任务或数据集上的性能）进行了比较。</p>
<p>值得注意的是，在染色质和剪接预测方面我们没有观察到显著改进，在增强子活性预测方面仅有适度的3%提升（补充图2），支持我们使用高效微调方法。总的来说，我们广泛的基准测试和结果展示了NT作为一种通用方法在处理许多不同基因组学任务时的灵活性和高准确性。</p>
<h3 id="基因组学基础模型的基准测试"><a class="markdownIt-Anchor" href="#基因组学基础模型的基准测试"></a> 基因组学基础模型的基准测试</h3>
<p>我们将<code>NT模型</code>与其他基因组学基础模型进行了比较：<code>DNABERT-2</code>、<code>HyenaDNA</code>（<code>1-kb</code>和<code>32-kb</code>上下文长度）和<code>Enformer</code>（将其用作预训练模型的替代架构）（图2a，b和方法）。我们将<code>DNABERT-1</code>排除在这个比较之外，因为它只能处理最大<code>512</code> bp的输入长度，因此不能用于大多数任务。为确保公平比较，所有模型都使用相同的协议在18个下游任务中进行微调和评估（方法）。</p>
<p>与<code>DNABERT-2</code>、<code>HyenaDNA-32-kb</code>和<code>Enformer</code>相比，我们的<code>Multispecies 2.5B</code>模型在所有任务中达到了最高的总体性能（图2a，b和表9）。尽管如此，<code>Enformer</code>在增强子预测和一些染色质任务中取得了最佳性能，证明它可以成为一个强大的DNA基础模型。我们的模型在所有启动子和剪接任务中都表现优于其他每个模型。值得注意的是，尽管<code>HyenaDNA</code>在人类参考基因组上进行预训练，我们的<code>Multispecies 2.5B</code>模型在所有18个任务中要么匹配（n=7）要么超越（n=11）它，突显了在多样化基因组序列集上预训练的优势。我们建立了一个包含所有模型在每个任务上结果的交互式排行榜（<a target="_blank" rel="noopener" href="https://huggingface.co/spaces/InstaDeepAI/nucleotide_transformer_benchmark">https://huggingface.co/spaces/InstaDeepAI/nucleotide_transformer_benchmark</a>）以方便比较。这代表了基因组学基础模型的广泛基准测试，应该作为进一步发展基因组学中语言模型的参考（图1c）。</p>
<h3 id="以无监督的方式检测已知的基因组元件"><a class="markdownIt-Anchor" href="#以无监督的方式检测已知的基因组元件"></a> 以无监督的方式检测已知的基因组元件</h3>
<p>为了深入了解<code>NT</code>模型的可解释性，并理解这些模型在进行预测时使用的序列元素类型，我们探索了它们架构的不同方面。首先，我们评估了这些嵌入在多大程度上可以捕获与五种<code>基因组元件</code>相关的序列信息（补充表7和10）。我们观察到，<code>NT</code>模型在没有任何监督的情况下，学会了区分具有独特注释的基因组序列，包括基因间区、内含子、编码区和非翻译区（<code>UTRs</code>），尽管在不同层次上的熟练程度不同（图3a、补充图7和方法）。特别是，<code>500M</code>大小的模型和那些在较少多样性序列上训练的模型，在基因组区域之间表现出较低的区分度，这再次证实了最大的模型在自监督训练期间更能捕获相关基因组模式的能力。</p>
<p>在<code>Multispecies 2.5B</code>模型的情况下，第1层观察到基因间和基因区域之间最强的区分，其次是第5层的<code>5'UTR</code>区域，以及第21层大多数区域之间的区分（图3a）。<code>3'UTR</code>区域与其他元素的有限区分表明，该模型尚未完全学会区分这种类型的元素，或者如先前研究所建议的，这些区域中可能有许多注释错误。与这些观察结果一致，我们的监督探测策略展示了对这些元素的高分类性能，特别是在更深层次，准确率值超过<code>0.78</code>（图3b）。这证明了<code>NT</code>模型已经以无监督的方式学会在其嵌入中检测已知的基因组元素，这可以被用于高效的下游基因组任务预测。</p>
<p><img src="/images/assets//image-20241216164914266.png" alt="image-20241216164914266" /></p>
<p>接下来，我们通过<code>注意力机制</code>的视角对模型进行分析，以理解<code>注意力层</code>捕获和使用了哪些序列区域。我们计算了每个模型头和层对包含九种不同类型基因组元素（与<code>基因结构</code>和<code>调控特征</code>相关）的序列的注意力百分比（图3c）。</p>
<blockquote>
<p><code>注意力机制</code>：一种让模型能够<code>动态关注输入中重要部分</code>的计算方法。它通过计算查询(query)与键值对(key-value pairs)的相关性来<code>分配权重</code>，从而让模型对重要信息给予更多&quot;关注&quot;。在Transformer中，自注意力机制让序列中的每个位置都能与其他位置进行交互，<code>捕获长距离依赖关系</code>，已成为现代深度学习的核心组件之一。</p>
<p><code>transformer</code>模型中的相关概念可参考这篇文章：</p>
<div class="post-link-card-wrap">
    <div class="post-link-card">
      <a href="/2024/11/04/skrzswes/" title="Transformer：Attention Is All You Need"></a>
      <div class="post-link-card-cover-wrap"><img src="/images/banner.webp" class="no-lightbox" title="Transformer：Attention Is All You Need" alt="Transformer：Attention Is All You Need"/></div>
      <div class="post-link-card-item-wrap">
        <div class="post-link-card-title">Transformer：Attention Is All You Need</div>
        <div class="post-link-card-excerpt">
# 文章链接

> Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., & Polosukhin, I. (2017). Attention is all you need. Advances in neural information processing syste</div>
      </div>
    </div>
  </div>
</blockquote>
<p>从形式上讲，当注意力头的注意力百分比显著超过该元素在预训练数据集中自然出现的频率时，就认为该注意力头识别出了特定元素（方法）。例如，<code>50%</code>的比例意味着，在人类基因组中平均而言，该特定头部<code>50%</code>的注意力指向了感兴趣的元素类型。通过将这种方法应用于在<code>6kb</code>序列中不同位置可能出现的每种类型元素（约10,000个不同序列，其中元素占序列的<code>2-11%</code>；补充表10），我们发现注意力在其不同的头部和层中明显聚焦于特定类型的基因组元素（图3d和补充图8-16）。</p>
<p>跨层的显著注意力头数量在不同模型间有显著差异，其中<code>Multispecies 2.5B</code>模型对内含子（<code>640</code>个头中的<code>117</code>个）、外显子（<code>n=72</code>）和转录因子（<code>TF</code>）结合位点（<code>n=74</code>）表现出最多的显著注意力头（补充图8、9和补充表12），尽管包含外显子和<code>TF</code>基序的序列比例相对较小。关于增强子，最大模型的最大注意力百分比最高，例如<code>1000G 2.5B</code>模型实现了接近<code>100%</code>的注意力（补充图15）。对于其他基因组元素，如<code>3'UTR</code>、启动子和<code>TF</code>结合位点，也观察到类似的模式，其中<code>1000G 2.5B</code>模型在首层展示了具有高度注意力的高度专门化头部（补充图8-16）。</p>
<p>为了更深入地了解预训练的<code>NT Multispecies 2.5B</code>模型在更高分辨率下的表现（关注更局部的序列特征），我们研究了不同类型基因组元素的<code>token</code>概率，作为模型学习的序列约束和重要性的度量。具体来说，我们计算了22号染色体上每个<code>6kb</code>窗口中的六聚体<code>token</code>概率（基于每次屏蔽一个<code>token</code>）。我们的发现显示，除了被模型很好重建的重复元素外，预训练模型还学习了各种基因结构和调控元素。这些包括受体和供体剪接位点、<code>polyA</code>信号、<code>CTCF</code>结合位点和其他基因组元素（补充图17a-d）。</p>
<blockquote>
<p><code>polyA信号</code>：真核生物mRNA 3’端的保守序列(通常是AAUAAA)，它指导mRNA的切割和多聚腺苷酸化过程，对mRNA的稳定性和成熟至关重要。</p>
<p><code>CTCF结合位点</code>：CTCF蛋白在基因组上的特异性结合序列，作为绝缘子和染色质结构调控因子，参与基因调控、染色质构象组织和转录绝缘等功能，在基因组三维结构形成中起重要作用。</p>
</blockquote>
<p>此外，我们将我们的<code>token</code>预测与<code>MST1R</code>基因外显子11的实验饱和突变剪接实验进行了比较（数据来自Braun等人）。这个分析揭示了实验突变效应与<code>Multispecies 2.5B</code>模型做出的<code>token</code>预测之间存在显著相关性（<code>皮尔逊相关系数（PCC）= 0.44</code>；补充图17e）。该模型不仅捕获了不同剪接位点的约束，还识别出第二个内含子中间对该外显子剪接至关重要的区域。这些结果有力地验证了<code>NT</code>模型在无监督预训练期间获得的生物学知识。</p>
<p>最后，对于在<code>DeepSTARR</code>增强子活性数据上完全微调的<code>Multispecies 2.5B</code>模型，我们检查了它是否特别学习了与增强子活性相关的<code>TF</code>基序及其相对重要性。我们使用了一个数据集，其中包含了数百个增强子序列中五种不同<code>TF</code>基序类型的数百个单独实例的实验突变，并评估了模型在预测这些突变效应方面的准确性。</p>
<p>与最先进的增强子活性<code>DeepSTARR</code>模型相比，我们的模型在四个<code>TF</code>基序上达到了相似的性能，并在<code>Dref</code>基序上展示了更优的性能（补充图18）。总的来说，这些结果说明了<code>NT</code>模型已经获得了恢复基因结构和基因组序列功能特性的能力，并直接将它们整合到其注意力机制中。这种编码的信息应该有助于评估遗传变异的重要性。</p>
<h3 id="预训练的嵌入预测突变的影响"><a class="markdownIt-Anchor" href="#预训练的嵌入预测突变的影响"></a> 预训练的嵌入预测突变的影响</h3>
<p>此外，我们评估了<code>NT模型</code>在评估各种<code>遗传变异</code>的严重程度和优先排序具有功能意义的变异方面的能力。我们首先研究了零样本评分的使用，这些评分用于预测模型在训练期间未见过的类别。</p>
<p>具体来说，我们使用<code>嵌入空间</code>中不同方面的向量距离以及从损失函数中得出的评分来计算零样本评分，并比较它们在严重程度不同的十种遗传变异类型中的分布情况（图4a和方法）。令人鼓舞的是，一些零样本评分在模型间表现出与严重程度的中等相关性（补充图19）。这说明了仅通过无监督训练就捕获了与遗传突变潜在严重程度相关的信息，并突出了评估不同评分方法的重要性。评分之间的高度相关性变异也表明，嵌入空间的不同方面可能更有效地捕获与严重程度相关的信息。</p>
<p>在这些评分中，余弦相似度在各个模型中表现出与严重程度最高的相关性，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 值范围从<code>-0.35</code>到<code>-0.3</code>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>6.55</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>186</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P &lt; 6.55 × 10^{-186}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord">.</span><span class="mord">5</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">8</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>；补充图19）。在所有模型中，最低的<code>余弦相似度评分</code>被分配给影响蛋白质功能的遗传变异，如终止获得变异，以及同义和错义变异（图4b）。相反，我们注意到较高的评分被分配给潜在功能重要性较低的变异，如基因间变异，突出了其在捕获遗传变异严重程度影响方面的潜在用途。</p>
<p><img src="/images/assets//image-20241216164949510.png" alt="image-20241216164949510" /></p>
<p>接下来，我们还探索了<code>零样本评分</code>在优先考虑<code>功能变异</code>以及具有<code>致病效应变异</code>方面的潜力。具体来说，我们评估了模型对影响基因表达调控的遗传变异（表达量性状位点，<code>eQTLs</code>）、与<code>DNA甲基化</code>变异相关的遗传变异（甲基化量性状位点，<code>meQTLs</code>）、在<code>ClinVar</code>数据库中注释为致病性的遗传变异以及在人类基因突变数据库（<code>HGMD</code>）中报告的遗传变异进行分类的能力。零样本评分表现出高分类性能，在四个任务中的最高<code>AUC</code>值范围从<code>0.7</code>到<code>0.8</code>（图4c）。在<code>ClinVar</code>变异中获得的最高性能（<code>Multispecies 2.5B</code>模型的<code>AUC</code>为<code>0.80</code>）表明，至少对于高度致病性变异，零样本评分可能可以直接应用。</p>
<p>最后，为了更正式地评估这些模型的有效性，我们还基于<code>微调模型</code>进行预测，并将其性能与多种方法进行了比较。这些方法包括那些测量基因组保守性的方法，以及从在功能特征上训练的模型中获得的评分。值得注意的是，微调模型或略微超过或紧密匹配了其他模型的性能（图4d和补充图20）。</p>
<p>对于优先排序分子表型（<code>eQTLs</code>和<code>meQTLs</code>）表现最好的模型是那些在人类序列上训练的模型，而对于优先排序致病性变异表现最好的模型则是基于多物种序列的模型。考虑到最严重的致病性变异往往由于氨基酸改变而影响基因功能，多物种模型可能利用了跨物种的序列变异来学习位点的保守程度。</p>
<p>我们的结果还表明，对于非编码变异（如<code>eQTLs</code>和<code>meQTLs</code>）的更高预测能力，可以通过从增加的人类遗传变异性中更好地学习序列变异来实现。此外，与零样本评分相比，点积在<code>eQTLs</code>和<code>meQTLs</code>上分别产生了<code>0.73</code>和<code>0.71</code>的<code>AUC</code>值，略微超过或匹配了通过微调模型获得的值。鉴于这些遗传变异往往位于调控区域内，这可能表明这些模型在没有任何监督的情况下，已经学会了区分与基因表达和甲基化变异相关的相关调控基因组特征。这与在层和头部之间观察到的注意力水平一致，特别是对于相关的<code>调控序列</code>，如增强子（图3a）和启动子（补充图13），这些序列已被证明在<code>meQTLs</code>和<code>eQTLs</code>中富集。总的来说，这些结果说明了基于<code>DNA</code>的转换器模型如何能帮助揭示和有助于理解与分子表型和疾病相关的变异的潜在生物学意义。</p>
<h3 id="基因组学中成本效益预测的模型优化"><a class="markdownIt-Anchor" href="#基因组学中成本效益预测的模型优化"></a> 基因组学中成本效益预测的模型优化</h3>
<p>最后，我们探索了通过整合当代架构进展并延长训练时间来优化我们表现最好的模型的可能性。我们开发了四个新的<code>NT</code>模型（<code>NT-v2</code>），参数数量从<code>5千万</code>到<code>5亿</code>不等，并引入了一系列架构改进（补充表1和方法）。这些改进包括引入旋转嵌入、实施<code>swiGLU</code>激活，以及消除<code>MLP</code>偏差和丢弃机制，这与最新的研究相一致。</p>
<p>此外，我们将上下文长度扩展到<code>12kb</code>以容纳更长的序列并捕获更远距离的基因组相互作用。我们将<code>250M</code>和<code>500M</code>参数模型的训练时间延长至包含<code>1万亿</code>个<code>token</code>，这与最近文献中的建议相一致（图5a）。在同一个多物种数据集上预训练后，所有四个<code>NT-v2</code>模型都经过了微调，并在相同的18个下游任务上进行评估，其结果与四个初始<code>NT</code>模型进行了比较（图5b和补充表7、9）。</p>
<p><img src="/images/assets//image-20241216165021903.png" alt="image-20241216165021903" /></p>
<p>我们观察到<code>50M参数</code>的<code>NT-v2模型</code>实现了与我们两个<code>NT 500M参数模型</code>以及在<code>1000基因组数据集</code>上训练的<code>2.5B参数模型</code>相近的性能。这表明，通过优质的预训练数据集，结合训练技术和架构的进步，可以在显著提高性能的同时实现模型参数数量惊人的50倍减少（图5c）。</p>
<p>事实上，<code>NT-v2 250M参数</code>和<code>500M参数模型</code>在保持参数数量显著较少的同时，成功实现了超越<code>2.5B参数多物种模型</code>的性能，并且将感受野加倍。特别值得注意的是，<code>NT-v2 250M参数模型</code>在我们的基准测试中取得了最佳性能（平均<code>MCC</code>为<code>0.769</code>），同时其参数量仅为<code>2.5B参数模型</code>的十分之一（图5c）。</p>
<p>为了进一步了解更长时间预训练的必要性，我们对<code>NT-v2模型</code>在预训练期间看到的标记数量与性能之间的关系进行了系统性评估（图5b）。这显示了<code>250M参数模型</code>仅在训练达到<code>9000亿个标记</code>后才略微超过<code>500M模型</code>。总的来说，配备了<code>12kb</code>上下文长度的<code>NT-v2模型</code>由于其紧凑的尺寸而适合在经济型加速器上部署。因此，对于希望在下游应用中利用最先进基础模型的用户来说，它们提供了一个经济可行且实用的选择。</p>
<p>作为一个相关的应用案例，在确立了一个表现良好的模型后，我们通过在<code>SpliceAI</code>剪接任务上评估<code>500M模型</code>来评估<code>NT-v2模型</code>更长上下文长度的优势。我们评估了<code>500M模型</code>，因为该模型在剪接相关任务上表现最好（补充表7和9）。我们调整了分类头以预测每个核苷酸位点是剪接供体、受体还是无剪接的概率（图5d和方法）。与<code>NT 6kb模型</code>相比，我们的<code>NT-v2 500M 12kb模型</code>将表现提高了1%，达到了<code>96%</code>的<code>top-k准确率</code>和<code>0.98</code>的<code>精确率-召回率AUC</code>（图5e）。这一性能超过了最先进的<code>SpliceAI-10k</code>模型，后者是在<code>15kb</code>输入序列上训练的。</p>
<p>值得注意的是，我们并没有试图专门针对剪接预测任务优化我们的模型架构；相反，我们采用了与其他下游任务类似的<code>微调方法</code>，仅在分类头上进行调整以产生核苷酸级别的预测。针对特定任务（如剪接）的进一步架构优化很可能会提高性能。总之，这些结果证实了<code>NT v1</code>和<code>v2模型</code>在广泛的基因组学任务中的实用性和有效性，只需要最小的修改和计算能力就能实现高准确率。</p>
<h2 id="讨论"><a class="markdownIt-Anchor" href="#讨论"></a> 讨论</h2>
<p>本研究尝试研究在<code>DNA序列</code>上预训练相同规模的<code>transformer模型</code>时，使用不同数据集的影响。基于不同的基因组预测任务的结果表明，种内（在单一物种的多个基因组上训练）和种间（在不同物种的基因组上）变异都显著影响任务的准确性（图1c和2a）。</p>
<p>在考虑的大多数人类预测任务中，在不同物种基因组上训练的模型表现优于仅在人类序列上训练的模型。这表明在不同物种上训练的<code>transformer模型</code>已经学会捕捉到在物种间具有功能重要性的基因组特征，从而能够更好地泛化到各种人类相关的预测任务中。</p>
<p>基于这一发现，我们预计未来的研究可能会受益于利用跨物种的遗传变异性，包括确定采样这种变异性的最佳方式。另一个有趣的研究方向是探索编码种内变异性的不同方法。我们混合所有个体基因组序列的方法只带来了有限的改进，这表明当大多数序列是共享的时候，利用来自不同个体的基因组可能并不那么简单。</p>
<p>本研究中训练的<code>transformer模型</code>参数范围从<code>5000万</code>到<code>25亿</code>，比<code>DNABERT-2</code>大20倍，比<code>Enformer</code>骨干模型大10倍。正如之前在自然语言处理研究中所证明的，我们在18个基因组预测任务上的结果证实，增加模型规模会持续改善性能。为了训练具有最大参数规模的模型，我们在16个计算节点上使用了总共128个GPU，持续28天。</p>
<p>在工程方面投入了大量工作以开发高效的训练程序，充分利用基础设施，这凸显了专门的基础设施和专用软件解决方案的重要性。然而，一旦训练完成，这些模型可以以相对较低的成本进行推理，我们提供了可以将这些模型应用于任何下游任务的笔记本，从而促进进一步的研究。</p>
<p>之前的工作主要基于在生物数据（主要是蛋白质序列）上训练的语言模型，主要通过探测最后一个<code>transformer层</code>来评估下游性能。这种选择可能是由于其<code>使用方便</code>、<code>性能相对较好</code>以及<code>计算复杂度低</code>。在本研究中，我们的目标是通过对不同<code>transformer层</code>、<code>下游模型</code>和<code>超参数</code>进行计算密集型和全面的探测来评估下游准确性。我们观察到最佳探测性能是在中间的<code>transformer层</code>上实现的（补充图1），这与计算生物学领域的最新工作和自然语言处理中的常见实践一致。仅通过探测，<code>Multispecies 2.5B模型</code>在18个任务中的8个任务上超过了<code>BPNet</code>基线模型。</p>
<p>此外，我们探索了一种最新的<code>下游微调技术</code>，该技术在<code>transformer</code>中引入少量可训练权重。这种方法提供了一个相对快速且资源高效的微调程序，与全模型微调（<code>IA3</code>）相比差异很小。值得注意的是，这种微调方法只需要总参数数量的0.1%，使得即使是我们最大的模型也能在单个GPU上在15分钟内完成微调。与大量的探测实验相比，这种技术在使用更少计算资源的同时产生了更好的结果，证实了下游模型工程可以带来性能改进。从操作角度来看，这种技术使得微调在训练和推理方面都能与探测相竞争，同时还能实现更好的性能。</p>
<p>虽然在大型数据集上进行广泛训练的优化架构的监督模型继续展现出优越的性能，但DNA语言方法在包括组蛋白修饰、剪接位点和调控元件表征等多个领域的各种任务中仍具有竞争力。</p>
<p>此外，<code>NT模型</code>代表了一种通用方法，可以无缝地适应人类和非人类物种的各种任务。当处理较小的数据集时，我们的无监督预训练方法的价值变得尤为明显，因为从头开始训练监督模型通常只能产生有限的结果。认识到基础基因组学模型在该领域的关键作用，我们进行了广泛的比较和基准测试研究，将我们的模型与四个具有不同架构的预训练模型进行评估：<code>DNABERT-2</code>、<code>HyenaDNA-1kb</code>、<code>HyenaDNA-32kb</code>和<code>Enformer</code>。这个健全的基准测试将作为未来基因组学领域语言模型发展的参考点。</p>
<p>通过对<code>transformer</code>架构的各种分析，我们已经证明这些模型不仅获得了<code>重建遗传变异</code>的能力（补充说明），还能识别关键的<code>调控基因组元件</code>。这一特性在注意力图、嵌入空间、标记重建和概率分布的分析中得到了证实。所有模型在多个头部和层中都能一致地检测到控制基因表达的关键调控元件，如增强子和启动子。此外，我们观察到每个模型至少包含一层，能产生清晰区分我们分析的五种基因组元件的嵌入。鉴于自监督训练促进了这些元件的检测，我们预计这种方法在未来的研究中可以用于表征或发现新的基因组元件。</p>
<p>我们已经证明，<code>transformer模型</code>可以匹配甚至超越其他用于<code>预测变异效应</code>和<code>致病性</code>的方法。除了开发监督型<code>transformer模型</code>，我们还展示了零样本（<code>zero-shot</code>）分数的实用性，特别是在预测非编码变异效应方面。考虑到这些基于零样本的分数仅可从基因组序列中推导出来，我们鼓励将其应用于功能注释有限的非人类生物。</p>
<p>最后，我们已经证明通过增强模型架构可以实现降低模型规模和提高性能的双重收益。我们后续的<code>NT-v2系列模型</code>具有<code>12kb</code>的上下文长度。为了说明这一点，这个长度分别是<code>DNABERT-1</code>（<code>500bp</code>）和<code>DNABERT-2</code>（<code>3kb</code>）平均上下文长度的24倍和4倍。这些改进的模型不仅展示了更好的下游性能，而且由于其紧凑的尺寸，结合我们引入的高效微调技术，适合在经济型硬件上执行和微调，这是一个额外的优势。</p>
<p>虽然我们的模型仍然具有有限的注意力范围，但最近开发的<code>Enformer模型</code>表明，将感知域增加到<code>200kb</code>对于捕捉人类基因组中的长程依赖关系是必要的。作者认为，这些长程依赖关系对于准确预测基因表达是必需的，因为基因表达受远端调控元件控制，这些元件通常位于转录起始位点<code>10-20kb</code>以外的位置。由于自注意力机制相对于序列长度的二次方缩放，使用标准<code>transformer架构</code>处理如此大的输入是不可行的。<code>Enformer模型</code>通过在到达<code>transformer层</code>之前通过卷积层传递序列来减少输入维度以解决这个问题。然而，这种选择降低了其在语言建模中的有效性。另一方面，最近的<code>HyenaDNA模型</code>训练时的感知域达到了<code>100万bp</code>，但我们的下游任务基准分析表明，当训练过程中使用的感知域增加时，这些模型的性能会快速下降。</p>
<blockquote>
<p>Enformer模型可参考：<div class="post-link-card-wrap">
    <div class="post-link-card">
      <a href="/2024/11/26/906k2592/" title="Enformer：通过整合长程相互作用从序列中有效预测基因表达"></a>
      <div class="post-link-card-cover-wrap"><img src="/images/banner.webp" class="no-lightbox" title="Enformer：通过整合长程相互作用从序列中有效预测基因表达" alt="Enformer：通过整合长程相互作用从序列中有效预测基因表达"/></div>
      <div class="post-link-card-item-wrap">
        <div class="post-link-card-title">Enformer：通过整合长程相互作用从序列中有效预测基因表达</div>
        <div class="post-link-card-excerpt">
# 文章链接

> Avsec, Ž., Agarwal, V., Visentin, D., Ledsam, J. R., Grabska-Barwinska, A., Taylor, K. R., Assael, Y., Jumper, J., Kohli, P., & Kelley, D. R. (2021). Effective gene expression prediction fr</div>
      </div>
    </div>
  </div></p>
</blockquote>
<p>基于我们的结果，我们建议开发能够<code>处理长输入同时保持对短输入高性能</code>的<code>transformer模型</code>是该领域一个有前景的方向。在多组学数据快速扩展的时代，我们最终预计本文提供的方法，以及可用的基准测试和代码，将促进基因组学中大型基础语言模型的采用、开发和改进。</p>
<h2 id="方法"><a class="markdownIt-Anchor" href="#方法"></a> 方法</h2>
<h3 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h3>
<p>语言模型（<code>LM</code>）主要在自然语言处理（<code>NLP</code>）领域开发，用于模拟口语。语言模型是一个在<code>token序列</code>（通常是词）上的概率分布，给定任何词序列，语言模型都会返回该句子存在的概率。语言模型因其能够利用大规模未标记数据集来生成通用表示而广受欢迎，这些表示即使在监督数据较少的情况下也能解决下游任务。训练语言模型的一种技术是预测序列中被遮蔽位置最可能出现的<code>token</code>，这通常被称为遮蔽语言建模（<code>MLM</code>）。</p>
<p>受蛋白质研究领域<code>MLM</code>成果的启发，该领域将蛋白质视为句子，氨基酸视为单词，我们将<code>MLM</code>应用于基因组学的转换器训练，将核苷酸序列视为句子，将<code>k-mers</code>（k=6）视为单词。转换器是一类在机器学习领域取得突破性进展的深度学习模型，包括<code>NLP</code>和计算机视觉。它们由一个初始嵌入层组成，该层将输入序列中的位置转换为嵌入向量，随后是一堆自注意力层，这些层依次细化这些嵌入。</p>
<p>用<code>MLM</code>训练语言模型转换器的主要技术称为双向编码器表示转换器（<code>BERT</code>）。在<code>BERT</code>中，序列中的所有位置都可以相互关注，允许信息双向流动，这在DNA序列的上下文中是必不可少的。在训练过程中，网络的最终嵌入被送入语言模型头，将其转换为输入序列上的概率分布。</p>
<h4 id="架构"><a class="markdownIt-Anchor" href="#架构"></a> 架构</h4>
<p>我们所有的模型都遵循仅编码器的转换器架构。嵌入层将<code>token序列</code>转换为<code>嵌入序列</code>。然后将位置编码添加到序列中的每个嵌入中，以向模型提供位置信息。我们使用可学习的位置编码层，最多可接受<code>1000个token</code>。</p>
<p>我们使用六聚体<code>token</code>作为序列长度（最多6kb）和嵌入大小之间的权衡，并且与其他<code>token</code>长度相比，它实现了最高的性能。然后<code>token</code>嵌入由转换器层堆栈处理。每个转换器层通过层归一化层和多头自注意力层转换其输入。自注意力层的输出通过跳跃连接与转换器层输入相加。该操作的结果随后通过新的层归一化层和具有<code>GELU</code>激活的两层感知器传递。</p>
<p>每个模型的头的数量、嵌入维度、感知器隐藏层中的神经元数量和层的总数可以在补充表1中找到。在自监督训练期间，堆栈最终层返回的嵌入由语言模型头转换为序列中每个位置上现有<code>token</code>的概率分布。</p>
<p>我们的第二版<code>NT-v2</code>模型包含一系列经证实更高效的架构变化：我们使用旋转嵌入而不是学习位置嵌入，这些嵌入在每个注意力层中使用；我们使用带有<code>swish</code>激活的门控线性单元，没有偏置，使<code>NLP</code>更有效。这些改进的模型还接受最多2048个<code>token</code>的序列，导致更长的上下文窗口为12kb。</p>
<h4 id="训练"><a class="markdownIt-Anchor" href="#训练"></a> 训练</h4>
<p>模型按照<code>BERT</code>方法进行训练。在每个训练步骤中，采样一批<code>tokenized序列</code>。批量大小根据可用硬件和模型大小进行调整。我们在<code>A100 GPU</code>集群上进行了所有实验，并采用了大小为14和2个序列的批次来训练&quot;500M&quot;和&quot;2.5B&quot;参数模型。</p>
<p>在序列中，15%的<code>token</code>子集中有80%被替换为特殊的遮蔽（&quot;MASK&quot;）token。对于人类参考基因组和多物种数据集的训练运行，15%子集中额外10%的<code>token</code>被替换为随机选择的标准<code>token</code>（任何不同于类（&quot;CLS&quot;）、填充（&quot;PAD&quot;）或<code>MASK token </code>的<code>token</code>），就像在<code>BERT</code>中那样。</p>
<p>对于1000G数据集的训练运行，我们跳过了这种额外的数据增强，因为添加的噪声大于人类基因组中存在的自然突变频率。对于每个批次，损失函数计算为在每个选定位置上预测<code>token</code>概率与真实<code>token</code>之间的<code>交叉熵损失之和</code>。梯度被累积以达到每批100万个<code>token</code>的有效批大小。</p>
<p>我们使用<code>Adam</code>优化器，学习率计划和标准的指数衰减率和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 常数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">β_1=0.9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mn>0.999</mn></mrow><annotation encoding="application/x-tex">β_2=0.999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">ϵ=1×10^{-8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span>。在第一个预热期间，学习率在16,000步内在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">5×10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1×10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> 之间线性增加，然后按照平方根衰减直到训练结束。</p>
<p>我们对<code>NT-v2</code>模型的超参数进行了细微调整：优化器和学习率计划保持不变；但是，我们将批量大小增加到512（每批100万个<code>token</code>）。受<code>Chinchilla</code>缩放定律的启发，与其他深度学习模型相比，我们还对<code>NT-v2</code>模型进行了更长时间的训练。具体来说，我们对<code>NT-v2 50M</code>和<code>250M</code>参数模型预训练了3000亿个<code>token</code>，而我们的&quot;250M&quot;和&quot;500M&quot;参数模型训练了高达1万亿个<code>token</code>，以了解相关的缩放定律。相比之下，<code>NT-v1 2.5B</code>参数模型训练了3000亿个<code>token</code>，而其500M对应模型训练了500亿个<code>token</code>。最后，我们使用以下<code>NT-v2</code>模型检查点：3000亿个<code>token</code>检查点用于&quot;50M&quot;和&quot;100M&quot;模型，8000亿个<code>token</code>检查点用于&quot;250M&quot;模型，以及9000亿个<code>token</code>检查点用于&quot;500M&quot;模型。</p>
<h4 id="探测"><a class="markdownIt-Anchor" href="#探测"></a> 探测</h4>
<p>我们将<strong>探测</strong>称为<strong>评估模型嵌入解决下游任务的质量</strong>。</p>
<p>训练后，对于每个任务，我们探测模型的每一层，并比较几种下游方法，以深入评估表示的能力。换句话说，给定下游任务的核苷酸序列数据集，我们计算并存储模型十个层返回的嵌入。然后，使用每个单独层的嵌入作为输入，我们训练了几个下游模型来解决下游任务。</p>
<p>我们测试了来自<code>scikit-learn</code>的默认超参数的逻辑回归和多层感知器（<code>MLP</code>）。由于我们观察到<code>超参数</code>的选择（如学习率、激活函数和每个隐藏层的层数）会影响最终性能，我们还对每个下游模型运行了超参数扫描。我们使用十折验证方案，其中训练数据集被分成十次训练和验证集，包含初始集的90%和10%的不同洗牌。</p>
<p>对于给定的超参数集，在十个分割上训练十个模型，并平均其验证性能。这个程序使用<code>Tree-structured Parzen Estimator</code>求解器引导超参数空间的搜索运行100次，然后在测试集上评估表现最好的模型组。因此，对于每个下游任务，对于每个预训练模型的十个层，在超参数搜索结束时记录测试集上的性能。表现最好的探测在预训练模型和其层之间的超参数在补充表8中报告。这种探测策略导致训练了76万个下游模型，这为训练和使用语言模型的各个方面提供了详细分析，例如不同层对下游任务性能的作用。</p>
<p>作为基线，我们评估了以<code>tokenized序列</code>作为输入的<code>逻辑回归模型</code>的性能，在通过转换器层传递<code>token</code>之前。使用原始<code>tokenized序列</code>作为输入比使用<code>token ids</code>被<code>one-hot编码</code>并通过<code>池化层</code>传递（在序列长度轴上求和或平均）的向量产生了更好的性能。</p>
<h4 id="微调"><a class="markdownIt-Anchor" href="#微调"></a> 微调</h4>
<p>除了通过在各个层中<code>提取嵌入</code>来探测我们的模型外，我们还通过<code>IA3</code>技术执行了参数高效的微调。使用此策略，根据任务需求将语言模型头替换为分类或回归头。</p>
<p>转换器层和嵌入层的权重被冻结，并引入了新的可学习权重。对于每个转换器层，我们引入了三个学习向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub><mo>∈</mo><msup><mi mathvariant="normal">R</mi><msub><mi>d</mi><mi>k</mi></msub></msup></mrow><annotation encoding="application/x-tex">l_k∈ℝ^{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord amsrm">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>v</mi></msub><mo>∈</mo><msup><mi mathvariant="normal">R</mi><msub><mi>d</mi><mi>v</mi></msub></msup></mrow><annotation encoding="application/x-tex">l_v∈ℝ^{d_v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord amsrm">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>f</mi></msub><mo>∈</mo><msup><mi mathvariant="normal">R</mi><msub><mi>d</mi><mi>f</mi></msub></msup></mrow><annotation encoding="application/x-tex">l_f∈ℝ^{d_f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord amsrm">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29011428571428566em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，它们在自注意力机制中被引入为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>softmax</mtext><mo stretchy="false">(</mo><mfrac><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>l</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>⊙</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mi>v</mi></msub><mo>⊙</mo><mi>V</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text {softmax}(\frac{Q(l_k)⊙K^T}{\sqrt{d_k}})(l_v⊙V)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.503331em;vertical-align:-0.9850000000000001em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.19778em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.87722em;"><span class="svg-align" style="top:-3.01em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8272199999999996em;"><span class="pstrut" style="height:3.01em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.09em;"><svg width='400em' height='1.09em' viewBox='0 0 400000 1090' preserveAspectRatio='xMinYMin slice'><path d='M95,712
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l4.819277108433735 -10.000000000000002
c5.3,-9.3,12,-14,20,-14
H400000v50H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M844 80h400000v50h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9850000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span></span></span></span></span></p>
<p>并在位置前馈网络中被引入为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>l</mi><mi>f</mi></msub><mo>⊙</mo><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mn>1</mn></msub><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(l_f⊙γ(W_1x))W_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">γ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span>是前馈网络的非线性，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">⊙</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊙</span></span></span></span> 表示逐元素乘法。这总共增加了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mi>k</mi></msub><mo>+</mo><msub><mi>d</mi><mi>v</mi></msub><mo>+</mo><msub><mi>d</mi><mi>f</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(d_k+d_v+d_f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>个新参数，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span>是转换器层的数量。我们将这些可学习的权重称为重缩放权重。</p>
<p>直觉是在微调期间，这些权重将对转换器层进行<code>加权</code>，以改善模型在下游任务上的最终表示，使得分类/回归头能够更准确地解决问题。由于我们在探测期间观察到层专门化，我们推测这种微调技术将同样选择对特定任务具有更大预测能力的层。</p>
<p>实际上，重缩放权重和分类/回归头权重引入的额外参数数量约占模型总权重的0.1%。这加快了微调速度，因为只需要更新一小部分参数。同样，它也减轻了存储要求，每个下游任务只需要为500万和25亿个参数创建0.1%的新参数空间，而不是使用传统微调。例如，对于25亿参数模型，权重为9.5GB。考虑到18个下游任务，传统的微调将需要9.5×18=171GB，而参数高效的微调只需要171MB。</p>
<p>与探测方案类似，训练数据集被分成<code>十次训练</code>和<code>验证集</code>，包含初始集的90%和10%的不同洗牌。对于每个分割，模型微调10,000步，然后使用产生最高验证分数的参数在测试集上评估模型。我们使用批量大小为8和<code>Adam</code>优化器，学习率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3×10^{-3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span>。其他优化器参数保持与训练方案相同。每个模型对每个任务微调10,000步。这些超参数是根据<code>NLP</code>领域的成功经验选择的。我们的实验表明，偏离这些超参数选择并未带来显著的收益。我们还将这种方法与从随机初始化的检查点进行微调进行了比较。</p>
<h4 id="与监督bpnet基线的比较"><a class="markdownIt-Anchor" href="#与监督bpnet基线的比较"></a> 与监督<code>BPNet</code>基线的比较</h4>
<p>作为<code>基线监督模型</code>，我们从头开始在18个任务中的每一个上训练了不同变体的<code>BPNet</code>卷积架构。我们测试了原始架构（<code>121,000</code>个参数）、一个大型架构（<code>2800万</code>个参数）和一个特大型架构（<code>1.13亿</code>个参数）。对于每一个，超参数都经过手动调整以在验证集上获得最佳性能。我们实施了<code>十折交叉验证</code>策略来衡量每种架构的18个模型的性能。</p>
<h4 id="与已发布的预训练基因组学模型的比较"><a class="markdownIt-Anchor" href="#与已发布的预训练基因组学模型的比较"></a> 与已发布的预训练基因组学模型的比较</h4>
<p>我们将<code>NT</code>模型在18个下游任务上的微调性能与三个不同的预训练模型进行了比较：<code>DNABERT-2</code>、<code>HyenaDNA</code>（1kb和32kb上下文长度）和<code>Enformer</code>。我们排除了<code>DNABERT-1</code>，因为它最多只能处理512bp的输入长度，因此不能用于大多数任务。我们将每个模型的架构和训练权重移植到我们的代码框架中，并对每个模型的转换器部分进行如上所述的参数高效微调，使用相同的交叉验证方案进行公平比较。所有结果都可以在交互式排行榜上查看（<a target="_blank" rel="noopener" href="https://huggingface.co/spaces/InstaDeepAI/nucleotide_transformer_benchmark">https://huggingface.co/spaces/InstaDeepAI/nucleotide_transformer_benchmark</a>）。只有对于<code>HyenaDNA</code>，由于我们的参数高效微调方法与模型架构不兼容，我们执行了完整的微调。</p>
<p>需要注意的是，<code>Enformer</code>最初是在监督方式下训练的，用于解决染色质和基因表达任务。为了进行基准测试，我们重用了提供的模型主干作为我们基准的预训练模型，这不是原始论文的预期和推荐用法；然而，我们认为这种比较很有趣，因为它突出了自监督和监督学习在预训练方面的差异，并观察到<code>Enformer</code>确实是一个非常有竞争力的基线，即使对于与基因表达不同的任务。不过，我们注意到<code>Enformer</code>最初使用不同的数据分割进行预训练，因此其在我们的基准评估中的表现可能由于潜在的数据泄露而被夸大。</p>
<h3 id="预训练数据集"><a class="markdownIt-Anchor" href="#预训练数据集"></a> 预训练数据集</h3>
<h4 id="人类参考基因组数据集"><a class="markdownIt-Anchor" href="#人类参考基因组数据集"></a> 人类参考基因组数据集</h4>
<p>人类参考数据集通过考虑参考组装<code>GRCh38/hg38</code>(<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.26">https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.26</a>)中所有常染色体和性染色体序列而构建，总计达到了<code>32亿</code>个核苷酸。</p>
<h4 id="千人基因组1000g数据集"><a class="markdownIt-Anchor" href="#千人基因组1000g数据集"></a> 千人基因组(1000G)数据集</h4>
<p>为了让模型学习人类中自然存在的<code>遗传多样性</code>，我们构建了一个包含来自<code>不同人群遗传变异</code>的训练数据集。具体来说，我们从千人基因组(1000G)计划下载了变异调用格式(<code>VCF</code>)文件(<a target="_blank" rel="noopener" href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20201028_3202_phased/">20201028_3202_phased</a>)，该计划旨在记录人类群体中频率至少为1%的遗传变异。</p>
<p>该数据集包含<code>3,202</code>个高覆盖度人类基因组，来自27个地理结构化的非洲、美洲、东亚和欧洲血统人群，详见附表2，总计达<code>20.5万亿</code>个核苷酸。这种多样性使数据集能够更好地表示人类遗传变异。为了允许从<code>VCF文件</code>中重建<code>FASTA格式</code>的单倍型，我们考虑了数据的相位版本，其中包含总计<code>1.25亿</code>个突变，其中<code>1.11亿</code>个和<code>1400万</code>个分别是单核苷酸多态性(<code>SNPs</code>)和插入缺失(<code>indels</code>)。</p>
<h4 id="多物种数据集"><a class="markdownIt-Anchor" href="#多物种数据集"></a> 多物种数据集</h4>
<p>多物种数据集的选择主要基于两个因素：</p>
<ol>
<li>
<p>现有参考基因组的质量和</p>
</li>
<li>
<p>所使用物种间的多样性</p>
</li>
</ol>
<p>本数据集中选择的基因组来自NCBI参考序列(<code>RefSeq</code>)集合(<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/">https://www.ncbi.nlm.nih.gov/</a>)。为确保基因组集的多样性，我们从<code>RefSeq</code>中每个主要分组(古菌、真菌、脊椎动物、哺乳动物、脊椎动物、其他等)在属级水平上随机选择了一个基因组。然而，由于细菌基因组数量众多，我们选择只包含其随机子集。未考虑植物和病毒基因组，因为它们的调控元件与本研究关注的不同。最终筛选得到的基因组集合下采样至总计<code>850</code>个物种，其基因组加起来达<code>1740亿</code>个核苷酸。如附表3所示，数据集中每个类别在总核苷酸数中的最终贡献与从NCBI解析的原始集合中的相同。最后，我们通过选择一些在文献中被广泛研究的基因组来丰富这个数据集(附表4)。</p>
<h3 id="数据准备"><a class="markdownIt-Anchor" href="#数据准备"></a> 数据准备</h3>
<p>在收集每个基因组/个体的<code>FASTA文件</code>后，它们被组装成每个数据集一个唯一的<code>FASTA文件</code>，然后在训练前进行预处理。在数据处理阶段，所有<code>非A、T、C、G</code>的核苷酸都被替换为<code>N</code>。使用分词器将字母串转换为标记序列。分词器使用的字母表包含通过组合<code>A、T、C、G</code>得到的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>4</mn><mn>6</mn></msup><mo>=</mo><mn>4</mn><mo separator="true">,</mo><mn>096</mn></mrow><annotation encoding="application/x-tex">4^6 = 4,096</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">9</span><span class="mord">6</span></span></span></span> 种可能的六聚体组合，以及代表独立<code>A、T、C、G和N</code>的五个额外标记。它还包括三个特殊标记，即<code>填充（PAD）</code>、<code>掩码（MASK</code>）和<code>序列开始</code>（也称为类别（CLS））标记。这样总共构成了<code>4,104</code>个标记的词汇表。要对输入序列进行分词，分词器将从类别标记开始，然后从左侧开始转换序列，在可能的情况下匹配六聚体标记，或在需要时（例如出现字母N时或序列长度不是6的倍数时）回退使用独立标记。</p>
<p>对于多物种和人类参考数据集，基因组被分割成<code>6,100</code>个核苷酸的重叠片段，每个片段分别与前一个和后一个片段共享前后<code>50</code>个核苷酸。作为数据增强练习，对于每个训练周期和片段，在0到100之间随机采样一个起始核苷酸索引，然后从这个核苷酸开始对序列进行分词，直到达到<code>1,000</code>个标记。根据数据集确定训练周期数，以使模型在训练期间总共处理<code>3000亿</code>个标记。</p>
<p>在每一步，随机从训练周期集中采样一批<code>序列输入模型</code>。对于1000G数据集，在每一步采样人类参考基因组的序列批次（按上述方式准备）。然后，对于每个采样的片段，随机选择1000G数据集中的一个个体，如果该个体在对应于该片段的位置和染色体上携带突变，则将这些突变引入序列并替换相应的标记。这种数据处理技术确保了在训练期间对基因组和个体的均匀采样，并且使我们能够仅高效存储每个个体的突变，而不是完整的基因组。</p>
<h4 id="硬件设施"><a class="markdownIt-Anchor" href="#硬件设施"></a> 硬件设施</h4>
<p>所有模型都在配备有16个节点的<code>Cambridge-1 Nvidia超级计算机</code>系统上训练，每个节点配备<code>8</code>个<code>A100 GPU</code>，总共使用了128个<code>A100 GPU</code>。在训练期间，模型权重在每个GPU上复制，而批次则在GPU间分片。在每个分片上计算梯度并累积，然后在设备间平均后反向传播。我们依赖Jax库(<a target="_blank" rel="noopener" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.pmap.html">https://jax.readthedocs.io/en/latest/_autosummary/jax.pmap.html</a>)，该库使用NCCL协议(<a target="_blank" rel="noopener" href="https://developer.nvidia.com/nccl">https://developer.nvidia.com/nccl</a>)处理节点和设备之间的通信，观察到训练时间随可用GPU数量几乎呈线性下降。<code>500M</code>参数模型在单个节点上训练一天，而<code>2.5B</code>参数模型需要整个集群训练<code>28</code>天。具有从<code>5000万</code>到<code>5亿</code>参数不等的<code>NT-v2模型</code>同样在单个节点上训练一天。所有微调运行都在配备8个<code>A100 GPU</code>的单个节点上执行。与训练运行一样，模型权重被复制，批次在<code>GPU</code>间分布。由于我们在微调时使用了8的批次大小，每个GPU在平均梯度并应用之前处理一个样本。平均而言，<code>500M参数模型</code>的微调运行持续20分钟，<code>2.5B参数模型</code>持续50分钟。</p>
<p>对于探测实验，所有<code>嵌入</code>（所有下游任务中所有序列的所有选定层）都在配备8个<code>A100 GPU</code>的单个节点上计算和存储，需要2天时间计算。然后，在一个由3000个CPU组成的集群上拟合76万个下游模型，需要2.5天。</p>
<h3 id="nucleotide-transformer下游任务"><a class="markdownIt-Anchor" href="#nucleotide-transformer下游任务"></a> Nucleotide Transformer下游任务</h3>
<h4 id="表观遗传标记预测"><a class="markdownIt-Anchor" href="#表观遗传标记预测"></a> 表观遗传标记预测</h4>
<p>从<code>ENCODE数据库</code>获取了人类<code>K562细胞系</code>中10个组蛋白<code>ChIP-seq</code>数据。我们下载了以下标识符的<code>bed narrowPeak</code>文件：<code>H3K4me3</code> (ENCFF706WUF)、<code>H3K27ac</code> (ENCFF544LXB)、<code>H3K27me3</code> (ENCFF323WOT)、<code>H3K4me1</code> (ENCFF135ZLM)、<code>H3K36me3</code> (ENCFF561OUZ)、<code>H3K9me3</code> (ENCFF963GZJ)、<code>H3K9ac</code> (ENCFF891CHI)、<code>H3K4me2</code> (ENCFF749KLQ)、<code>H4K20me1</code> (ENCFF909RKY)和<code>H2AFZ</code> (ENCFF213OTI)。对于每个数据集，我们选择包含峰值的<code>1kb基因组序列</code>作为正例，所有不与峰值重叠的<code>1kb序列</code>作为负例。</p>
<h4 id="启动子序列预测"><a class="markdownIt-Anchor" href="#启动子序列预测"></a> 启动子序列预测</h4>
<p>我们构建了一个<code>启动子序列</code>数据集来评估模型识别启动子基序的能力。我们从真核生物启动子数据库下载了所有人类启动子，跨越转录起始位点上游<code>49bp</code>和下游<code>10bp</code>(<a target="_blank" rel="noopener" href="https://epd.expasy.org/ftp/epdnew/H_sapiens/006/Hs_EPDnew_006_hg38.bed">Hs_EPDnew_006_hg38.bed</a>)。这产生了<code>29,598</code>个启动子区域，其中<code>3,065</code>个是TATA盒启动子（使用<a target="_blank" rel="noopener" href="https://epd.expasy.org/ftp/epdnew/H_sapiens/006/db/promoter_motifs.txt">promoter_motifs.txt</a>的基序注释）。我们选择包含启动子的<code>300bp</code>基因组序列作为正例，所有不与启动子重叠的<code>300bp</code>序列作为负例。这些正例和负例用于创建三个不同的二元分类任务：存在任何启动子元件（所有启动子）、具有TATA盒基序的启动子（TATA启动子）或不具有TATA盒基序的启动子（非TATA启动子）。</p>
<h4 id="增强子序列预测"><a class="markdownIt-Anchor" href="#增强子序列预测"></a> 增强子序列预测</h4>
<p>从<code>ENCODE</code>的<code>SCREEN数据库</code>获取了人类增强子元件。远端和近端增强子被合并。基于Meuleman等人的词汇表，增强子被分为组织特异性和组织不变性。与组织不变性区域重叠的增强子被定义为该类型，而所有其他增强子被定义为组织特异性。</p>
<p>我们选择包含增强子的<code>400bp</code>基因组序列作为正例，所有不与增强子重叠的<code>400bp</code>序列作为负例。我们创建了一个用于预测序列中是否存在增强子元件的二元分类任务（增强子）和一个多标签预测任务，标签为组织特异性增强子、组织不变性增强子或无（增强子类型）。</p>
<h4 id="剪接位点预测"><a class="markdownIt-Anchor" href="#剪接位点预测"></a> 剪接位点预测</h4>
<p>我们从<code>GENCODE V44基因注释</code>获取了所有人类注释的剪接位点。排除了<code>level-3转录本</code>（自动化注释）的注释，以使所有训练数据都由人工注释。我们使用<code>HISAT2</code>的<code>extract_splice_sites.py</code>来提取相应的剪接位点注释。我们选择中心包含剪接受体或供体位点的<code>600bp</code>基因组序列作为正例，所有不与剪接位点重叠的<code>600bp</code>序列作为负例。我们使用这些序列创建三个不同的任务来评估<code>剪接预测</code>：标签为受体、供体或无的多标签预测任务（所有剪接位点）；预测剪接受体的二元分类任务（剪接受体）；以及预测剪接供体的二元分类任务（剪接供体）。</p>
<h3 id="数据集分割和性能评估"><a class="markdownIt-Anchor" href="#数据集分割和性能评估"></a> 数据集分割和性能评估</h3>
<p>在人类基因组的不同<code>染色体集</code>上进行模型训练和性能评估。具体来说，染色体<code>20</code>和<code>21</code>的序列用于测试，其余用于训练不同的模型。删除了含有N的序列。我们通过对负例进行下采样至与正例相同数量来平衡每个数据集。为了获得可以快速基准测试任何新设计选择或模型的小型数据集，我们进一步随机对样本进行下采样，训练集最多<code>30,000</code>个，验证和测试集最多<code>3,000</code>个（详见附表5）。</p>
<p>我们使用<code>十折交叉验证</code>方案来评估每个模型，其中训练集被分成十份，每次使用其中九份进行训练，保留十分之一用于验证和选择最终检查点。我们对每个模型重复此程序十次，每次保留不同的十分之一用于验证，并在相同的保留测试集上评估最终性能。我们使用十折中的中位数性能作为每个模型在给定任务上的最终性能度量。</p>
<p>为了在任务间进行一致的性能评估，我们使用二元或多类<code>MCC</code>（Matthews相关系数）作为度量标准，因为它对不均衡的标签比例具有鲁棒性。为了最终比较模型之间的性能，我们计算了每个模型在三个不同任务类别（染色质谱系、调控元件和剪接）中的平均MCC，其中每个类别我们使用任务间的中位数MCC。</p>
<h3 id="其他下游任务"><a class="markdownIt-Anchor" href="#其他下游任务"></a> 其他下游任务</h3>
<h4 id="染色质谱系预测"><a class="markdownIt-Anchor" href="#染色质谱系预测"></a> 染色质谱系预测</h4>
<p>我们使用了Zhou等人编制的<code>DeepSEA数据集</code>进行染色质谱系预测。该数据集由<code>240万</code>个序列组成，每个序列大小为1000个核苷酸，并与919个染色质特征相关联。这些包括690个转录因子、125个<code>DNase</code>和104个<code>组蛋白特征</code>。如原始出版物所述，我们的模型同时在919个分类任务上进行训练，有919个独立的分类头，损失函数取为交叉熵损失的平均值。由于每个标签都高度不平衡，主要由负样本组成，因此与正样本相关的损失被放大了8倍。与<code>DeepSEA方法</code>不同的是，后者独立训练了两个模型，一个在正向序列上，一个在相应的反向互补序列上，并评估它们预测的平均值，而这里展示的模型仅在正向序列上训练。</p>
<h4 id="spliceai基准测试"><a class="markdownIt-Anchor" href="#spliceai基准测试"></a> SpliceAI基准测试</h4>
<p>我们使用<code>Illumina Basespace平台</code>上可用的脚本来复现<code>SpliceAI</code>中展示的训练数据集。简而言之，这个训练数据集使用<code>GENCODE V24lift37注释</code>和来自<code>GTEx队列的RNA-seq数据</code>构建，仅关注主要转录本的剪接位点注释。</p>
<p>训练数据集包括位于染色体<code>2</code>、<code>4</code>、<code>6</code>、<code>8</code>和<code>10-22</code>以及<code>X</code>和<code>Y</code>染色体上的基因的注释，而剩余染色体上非旁系同源基因的注释构成了测试数据集。这个流程产生的每个序列长度为<code>15,000bp</code>，中心<code>5,000bp</code>包含要预测的位点。关于训练数据集构建的更多细节可在原始出版物中找到。我们调整了这个原始SpliceAI数据集以运行我们的模型，方法是将序列长度减少到<code>6,000bp</code>（对于NT-v1模型）和<code>12,000bp</code>（对于NT-v2模型），减少了侧翼上下文但保持中心<code>5,000bp</code>。我们还删除了包含N的序列。在与第一个数据集上的SpliceAI进行比较时（我们称之为SpliceAI-6k），我们附加了<code>9,000</code>个&quot;N&quot;核苷酸作为侧翼序列，因为SpliceAI基于具有<code>15,000bp</code>输入的模型。在与第二个数据集上的SpliceAI进行比较时，我们报告了原始出版物中呈现的性能，与本数据集相比，包括<code>15,000bp</code>而不是<code>12,000bp</code>的序列长度。</p>
<p>这个任务是一个类似于<code>SpliceAI</code>的多标签分类任务，针对输入序列的每个核苷酸（图5d）。对于transformer模型输出的每个嵌入，一个头部为该标记嵌入所代表的六个核苷酸中的每一个预测三个标签概率：剪接受体、剪接供体或无。该头部是一个简单的分类层，预测18个类别（六个核苷酸中的每一个都有三个标签）。为确保每个嵌入都与一个六聚体相关联，序列被切割以使其长度能被6整除。</p>
<p>此外，从训练和测试集中删除了所有包含N的序列，这仅占数据的很少一部分。值得注意的是，如果我们使用字节对编码分词器（如<code>DNABERT-2</code>），每个嵌入所代表的核苷酸数量会变化，这会使核苷酸级别的预测任务变得更加困难。</p>
<h4 id="增强子活性预测"><a class="markdownIt-Anchor" href="#增强子活性预测"></a> 增强子活性预测</h4>
<p>我们使用了de Almeida等人发布的<code>DeepSTARR增强子活性数据集</code>。该数据集由484,052个大小为249个核苷酸的DNA序列组成，每个序列都测量了它们对发育型或管家型启动子的定量增强子活性。</p>
<p>我们在模型中添加了两个独立的<code>回归头</code>以同时预测这两种增强子活性。遵循先前工作的方法，我们选择将这个回归任务作为<code>多标签分类问题</code>处理。</p>
<p>具体来说，每个标签<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>被离散化为一组50个值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>b</mi><mi>i</mi></msub><msub><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">(b_i)_{i∈[1,50]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span><span class="mord mtight">0</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>，在最小值和最大值之间均匀分布。对于每个标签，模型预测归一化权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">(w_i)_{i∈[1,50]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span><span class="mord mtight">0</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>，使得：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>50</mn></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y = \sum_{i=1}^{50} w_ib_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0787820000000004em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="其他性能分析"><a class="markdownIt-Anchor" href="#其他性能分析"></a> 其他性能分析</h3>
<h4 id="t-sne嵌入投影"><a class="markdownIt-Anchor" href="#t-sne嵌入投影"></a> t-SNE嵌入投影</h4>
<p>使用 t-分布随机邻域嵌入（<code>t-SNE</code>）将<code>NT</code>内部嵌入降维到二维向量，以可视化不同基因组元件的分离情况。在几个<code>transformer层</code>输出计算了每个基因组元件的<code>NT嵌入</code>，并计算对应于该元件的序列位置的平均嵌入。然后将这些平均嵌入作为输入传递到带有默认参数的<code>sklearn Python</code>包中的<code>t-SNE降维对象</code>。</p>
<h4 id="重构准确率和复杂度perplexity"><a class="markdownIt-Anchor" href="#重构准确率和复杂度perplexity"></a> 重构准确率和复杂度（perplexity）</h4>
<p>我们研究了预训练模型如何重构被掩码的标记。我们考虑一个带参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> 的训练好的语言模型。在一个感兴趣的核苷酸序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> 内，我们使用两种策略之一来掩码标记（我们用掩码（<code>MASK</code>）标记替换这些位置的标记）。</p>
<p>我们要么只掩码序列的中心标记，要么随机掩码序列内<code>15%</code>的标记。然后将掩码序列输入模型，并检索每个掩码位置的标记概率。损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">l(θ,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> 和准确率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">acc(θ,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> 定义如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>d</mi></mrow></msub><msub><mo>∑</mo><mrow><mi>t</mi><mi>o</mi><mi>k</mi><mo>∈</mo><mi mathvariant="script">V</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>t</mi><mi>o</mi><mi>k</mi><mo stretchy="false">)</mo><mo>⋅</mo><mn>1</mn><mo stretchy="false">(</mo><mi>t</mi><mi>o</mi><mi>k</mi><mo>=</mo><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>d</mi></mrow></msub><mn>1</mn><mo stretchy="false">(</mo><mi>arg</mi><mo>⁡</mo><msub><mo><mi>max</mi><mo>⁡</mo></mo><mrow><mi>t</mi><mi>o</mi><mi>k</mi><mo>∈</mo><mi mathvariant="script">V</mi></mrow></msub><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>t</mi><mi>o</mi><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
l(θ,s) = \sum_{i∈masked} \sum_{tok∈\mathcal{V}} \log p(θ,i,tok) \cdot 1(tok=s(i)) \\
acc(θ,s) = \frac{1}{|masked|} \sum_{i∈masked} 1(\arg\max_{tok∈\mathcal{V}}(\log p(θ,i,tok))=s(i))
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7365em;"><span style="top:-3.7365em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-2.2965em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.65em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5249999999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999985em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2365em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>masked</mtext></mrow><annotation encoding="application/x-tex">\text {masked}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">masked</span></span></span></span></span> 是掩码位置的集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi></mrow><annotation encoding="application/x-tex">\mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span> 是词汇表（所有现有标记的集合）。</p>
<p><code>复杂度</code>通常在自回归生成模型的上下文中定义。这里，我们依赖Rives提出的另一种定义，将其定义为在掩码位置上计算的损失函数的指数：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>x</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">perplexity(θ,s) = 2^{l(θ,s)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><code>复杂度衡量模型重构掩码位置的能力</code>，比准确率更精细，因为它也考虑了幅度。与准确率相反，较低的复杂度表示更好的重构能力，因此性能更好。</p>
<h4 id="不同基因组元素中的标记重构"><a class="markdownIt-Anchor" href="#不同基因组元素中的标记重构"></a> 不同基因组元素中的标记重构</h4>
<p>我们还在整个<code>22号染色体</code>上对 6kb 窗口执行了这种标记重构方法。我们只保留没有N的窗口。对于每个窗口，每次掩码一个标记，恢复序列中原始标记的预测概率。</p>
<p>我们在<code>WashU表观基因组浏览器</code>会话中显示这些分数（<a target="_blank" rel="noopener" href="https://shorturl.at/jov28">https://shorturl.at/jov28</a>）。为了获得不同类型基因组元素的平均标记概率，我们从<code>Ensembl</code>（外显子、内含子、剪接受体和供体、5’UTR、3’UTR、转录起始位点和转录终止位点）（<a target="_blank" rel="noopener" href="https://www.ensembl.org/info/data/ftp/index.html">https://www.ensembl.org/info/data/ftp/index.html</a>）、GENCODE的polyA信号位点（<a target="_blank" rel="noopener" href="https://www.gencodegenes.org/human/">https://www.gencodegenes.org/human/</a>）和<code>ENCODE</code>的调控元件（来自<code>SCREEN数据库</code>的增强子、启动子和CTCF结合位点）（<a target="_blank" rel="noopener" href="https://api.wenglab.org/screen_v13/fdownloads/GRCh38-ccREs.bed">https://api.wenglab.org/screen_v13/fdownloads/GRCh38-ccREs.bed</a>）检索基因注释区域。</p>
<h4 id="功能变异优先级排序"><a class="markdownIt-Anchor" href="#功能变异优先级排序"></a> 功能变异优先级排序</h4>
<p>为了获得具有<code>不同严重程度</code>的遗传变异，我们使用了变异效应预测（<code>VEP</code>）软件并对整个人类基因组的序列进行注释。</p>
<p>具体来说，我们在整个人类基因组中随机采样序列，并保留了注释为以下任何类别的序列中的遗传变异：<code>&quot;内含子变异&quot;、&quot;基因间变异&quot;、&quot;调控区域变异&quot;、&quot;错义变异&quot;、&quot;3'UTR变异&quot;、&quot;同义变异&quot;、&quot;</code>TF<code>结合位点变异&quot;、&quot;5'UTR变异&quot;、&quot;剪接区域变异&quot;和&quot;终止获得变异&quot;</code>。</p>
<p>在只保留<code>SNP</code>并过滤掉注释为多个结果的变异（例如那些注释为终止获得和剪接变异的变异）后，我们获得了每个类别920个遗传变异的最终数据集。</p>
<p>作为功能性遗传变异的正集，我们从四个不同来源编制了<code>SNP</code>。我们使用来自<code>GRASP</code>数据库的与基因表达（<code>eQTL</code>）和<code>meQTL</code>相关的<code>SNP</code>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> 值 &lt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>，来自<code>ClinVar</code>的带有&quot;可能致病&quot;注释的<code>SNP</code>以及<code>HGMD</code>（公共v.2020.4）中报告的<code>SNP</code>。</p>
<p>经过这些过滤，我们分别保留了<code>eQTL</code>、<code>meQTL</code>、<code>ClinVar</code>和<code>HGMD SNP</code>数据集的总计80,590、11,734、70,224和14,626个遗传变异。对于这四个数据集中的每一个，我们然后基于来自1000G项目的<code>SNP</code>构建了一组阴性变异，这些<code>SNP</code>的次要等位基因频率&gt;5%，与测试数据集中报告的任何变异都不重叠，并且在相关变异的100 kb内，从而产生四个平衡数据集。</p>
<p>对于给定的感兴趣位点，要计算基于零样本的分数，我们执行以下操作：对于每个<code>SNP</code>，我们基于人类参考基因组获得以<code>SNP</code>为中心的6,000 bp序列。然后我们创建两个序列，一个携带<code>SNP</code>位置的参考等位基因，另一个携带替代等位基因。然后我们计算几个零样本分数，这些分数捕获这两个序列之间嵌入空间中的矢量距离的不同方面，即：</p>
<ul>
<li>
<p>L1距离（曼哈顿距离）</p>
</li>
<li>
<p>L2距离（欧几里得距离）</p>
</li>
<li>
<p>余弦相似度</p>
</li>
<li>
<p>点积（未归一化的余弦相似度）</p>
</li>
</ul>
<p>我们还计算了<code>替代等位基因</code>的损失以及携带替代和参考等位基因的序列之间的损失差异，作为另外两个零样本分数。在功能性变异的情况下，除了零样本分数外，我们还微调了<code>transformer模型</code>来分类阳性和阴性变异。我们采用了类似于先前描述的策略，主要区别在于训练集和测试集按染色体划分，并严格保持不重叠。</p>
<p>具体来说，我们将22个染色体分为五组，依次使用每组作为测试集，其他四组作为训练集。通过微调训练集，我们可以得出测试集中每个序列作为阳性变异的概率。我们使用这些概率作为每个<code>SNP</code>的分数。</p>
<p>为了将这些预测与其他方法进行比较，我们从四个数据集中的每一个随机抽样10,000个阳性和阴性<code>SNP</code>。然后我们使用组合注释依赖性消减工具（<code>v.GRCh38-v1.6</code>）来计算<code>CADD</code>、<code>GERP</code>、<code>phastCons</code>和<code>phyloP</code>分数。<code>DeepSEA</code>分数是使用 <a target="_blank" rel="noopener" href="https://hb.flatironinstitute.org/sei/">https://hb.flatironinstitute.org/sei/</a> 提供的<code>Beluga模型</code>计算的。考虑的分数是报告给每个<code>SNP</code>的&quot;疾病影响分数&quot;。</p>
<h4 id="注意力图分析"><a class="markdownIt-Anchor" href="#注意力图分析"></a> 注意力图分析</h4>
<p>我们分析了从预训练模型收集的<code>注意力图</code>如何捕获关键<code>基因组元素</code>。我们遵循先前工作中提出的方法。对于基因组元素，我们定义了标记上的指示函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>，如果标记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 内的一个或多个核苷酸属于该元素，则等于1，否则等于0。</p>
<p>我们计算了在一个注意力头中，在核苷酸序列数据集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 上聚合的、集中在该基因组元素上的注意力的平均比例：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>α</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>X</mi></mrow></munder><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><munder><mo>∑</mo><mi>j</mi></munder><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mn>1</mn><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>μ</mi><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><munder><mo>∑</mo><mi>j</mi></munder><mn>1</mn><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>μ</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_α(f) = \frac{1}{|X|} \sum_{x∈X} \frac{\sum_i\sum_j f(i)1(α(i,j)&gt;μ)}{\sum_i\sum_j 1(α(i,j)&gt;μ)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.932524em;vertical-align:-1.321706em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">∣</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.610818em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">μ</span><span class="mclose">)</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.860818em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">μ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218180000000002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">α(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 是标记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 和标记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 之间的注意力系数，定义为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>α</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_i α_{i,j}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> 是置信度阈值。</p>
<p>我们计算了所有模型的所有头和所有层的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>α</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_α(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span>值，并考虑了九个元素（<code>&quot;5'UTR&quot;、&quot;3'UTR&quot;、&quot;外显子&quot;、&quot;内含子&quot;、&quot;增强子&quot;、&quot;启动子&quot;、&quot;CTCF结合位点&quot;、&quot;开放染色质&quot;和&quot;转录因子结合位点&quot;</code>）。</p>
<p>我们在一个由90,000个序列组成的数据集上执行这些分析，每个特征10,000个，长度为6 kb，从人类参考基因组中提取。每个元素所属标记的平均比例可以在补充表10中找到。对于每个序列，在数据集创建期间均匀采样特征在序列中的位置。如先前工作所建议，我们为所有实验选择了置信度阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">μ=0.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span></span></span></span>。</p>
<p>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>α</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_α(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span> 的数量显著大于该特征在数据集中的自然出现频率（补充表10），我们认为该特征被注意力头捕获。为了验证这一点，我们进行了两个比例的<code>z检验</code>，零假设为特征的自然频率，备择假设为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>α</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_α(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span>。使用每个模型的总头数作为 0.05 显著性水平 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">α</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 的<code>Bonferroni校正</code>。我们为每个模型中的每个头部对每个基因组元素计算<code>z分数</code>和相关的<code>P值</code>，如下所示：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Z</mi><mo>=</mo><mfrac><mrow><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mn>2</mn></msub></mrow><msqrt><mrow><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="false">)</mo></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z = \frac{\hat{p}_1-\hat{p}_2}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{n_1}+\frac{1}{n_2})}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.15644em;vertical-align:-1.7850000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.0749999999999997em;"><span class="pstrut" style="height:3.2050039999999997em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.205004em;"><span class="svg-align" style="top:-3.81em;"><span class="pstrut" style="height:3.81em;"></span><span class="mord" style="padding-left:1em;"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.155004em;"><span class="pstrut" style="height:3.81em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8900000000000001em;"><svg width='400em' height='1.8900000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 100
l3.1948881789137387 -10.000000000000002
c4,-6.7,10,-10,18,-10 H400000v50
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1011 80h400000v50h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.654996em;"><span></span></span></span></span></span></span></span><span style="top:-3.430004em;"><span class="pstrut" style="height:3.2050039999999997em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.882004em;"><span class="pstrut" style="height:3.2050039999999997em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7850000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\hat{p}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示与每个基因组元素相关的高于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> 的注意力的比例，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\hat{p}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示序列中被该基因组元素占据的比例，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是注意力高于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> 的序列位置总数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是序列位置总数。<code>P值</code>低于<code>Bonferroni校正显著性水平</code>的注意力头被认为是显著的。</p>
<h4 id="预测deepstarr数据中重要的tf基序实例"><a class="markdownIt-Anchor" href="#预测deepstarr数据中重要的tf基序实例"></a> 预测<code>DeepSTARR</code>数据中重要的TF基序实例</h4>
<p>我们从<code>DeepSTARR</code>数据集中检索实验突变数据，其中单个<code>TF</code>基序实例被突变，并测量它们对发育和管家增强子活性的影响。我们评估了完全微调的<code>NT 2.5B Multispecies</code>模型（因为它是测试集性能最高的模型）通过预测野生型和相应基序突变序列的活性并计算它们的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>log</mtext><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text {log}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mord"><span class="mord text"><span class="mord">log</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span></span></span></span> 倍数变化来预测每个<code>TF</code>基序实例贡献的性能。我们将我们预测的突变效应与原始方法<code>DeepSTARR</code>预测的效应和实验得到的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>log</mtext><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text {log}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mord"><span class="mord text"><span class="mord">log</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span></span></span></span> 倍数变化进行了比较。</p>
<h3 id="数据可用性"><a class="markdownIt-Anchor" href="#数据可用性"></a> 数据可用性</h3>
<p>NT预训练序列来自公开可用的资源。1000G序列从<a target="_blank" rel="noopener" href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage">1000G项目数据库</a>获得，人类和多物种参考基因组从<a target="_blank" rel="noopener" href="https://ftp.ncbi.nlm.nih.gov/genomes/refseq/">NCBI RefSeq数据库</a>获得。基因注释从<a target="_blank" rel="noopener" href="https://www.gencodegenes.org/">GENCODE</a>和<a target="_blank" rel="noopener" href="https://www.ensembl.org">Ensembl数据库</a>获得。使用<a target="_blank" rel="noopener" href="https://www.ensembl.org/info/docs/tools/vep/index.html">Ensembl的VEP API</a>获得变异效应预测。致病性和调控变异从<a target="_blank" rel="noopener" href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/">ClinVar</a>、<a target="_blank" rel="noopener" href="https://grasp.nhlbi.nih.gov">GRASP</a>和<code>HGMD</code>（公共v.2020.4）通过<code>Ensembl Biomart</code>提取。NT下游任务是从以下公开可用资源中整理的：<a target="_blank" rel="noopener" href="https://www.encodeproject.org/">ENCODE</a>、<a target="_blank" rel="noopener" href="https://screen.wenglab.org/">SCREEN</a>和<a target="_blank" rel="noopener" href="https://www.meuleman.org/research/dhsindex/">DHSIndex</a>、<a target="_blank" rel="noopener" href="https://epd.expasy.org/epd/">真核生物启动子数据库</a>和<a target="_blank" rel="noopener" href="https://www.gencodegenes.org/">GENCODE</a>（补充表5）。我们在<code>HuggingFace</code>上提供了我们的多物种和人类预训练数据集版本（<a target="_blank" rel="noopener" href="https://huggingface.co/collections/InstaDeepAI/nucleotide-transformer-65099cdde13ff96230f2e592">NT models集合</a>）以及我们的下游任务基准测试（<a target="_blank" rel="noopener" href="https://huggingface.co/datasets/InstaDeepAI/nucleotide_transformer_downstream_tasks_revised">NT下游任务集</a>）。我们建立了一个<a target="_blank" rel="noopener" href="https://huggingface.co/spaces/InstaDeepAI/nucleotide_transformer_benchmark">交互式排行榜</a>，其中包含所有模型在每个任务上的结果，以便于比较。我们还在<code>WashU</code>表观基因组浏览器上创建了一个<a target="_blank" rel="noopener" href="https://shorturl.at/jov28">交互式浏览器会话</a>，显示整个22号染色体上预训练模型的标记概率。</p>
<h3 id="代码可用性"><a class="markdownIt-Anchor" href="#代码可用性"></a> 代码可用性</h3>
<p>预训练transformer模型的代码和权重以及<code>Jax</code>中的推理代码可在<a target="_blank" rel="noopener" href="https://github.com/instadeepai/nucleotide-transformer">NT GitHub仓库</a>获得用于研究目的。<code>PyTorch</code>中模型的<code>HuggingFace</code>版本可在<a target="_blank" rel="noopener" href="https://huggingface.co/collections/InstaDeepAI/nucleotide-transformer-65099cdde13ff96230f2e592">NT HuggingFace集合</a>找到。示例笔记本可在<code>HuggingFace</code>的<a target="_blank" rel="noopener" href="https://huggingface.co/docs/transformers/notebooks#pytorch-bio">PyTorch生物示例页面</a>获得。</p>
<h1 id="补充信息"><a class="markdownIt-Anchor" href="#补充信息"></a> 补充信息</h1>
<p>补充说明，补充表1-12和补充图1-20。请在<a target="_blank" rel="noopener" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41592-024-02523-z/MediaObjects/41592_2024_2523_MOESM1_ESM.pdf">这里</a>下载。</p>
<h1 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> 参考文献</h1>
<ol>
<li>
<p>Devlin, J., Chang, M.-W., Lee, K. &amp; Toutanova, K. Bert: pre-training of deep bidirectional transformers for language understanding. Preprint at <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1810.04805">https://arxiv.org/abs/1810.04805</a> (2018).</p>
</li>
<li>
<p>Brown, T. et al. Language models are few-shot learners. Adv. Neural Inf. Process. (2020).</p>
</li>
<li>
<p>Jumper, J. et al. Highly accurate protein structure prediction with alphafold. Nature 596, 583-589 (2021).</p>
</li>
<li>
<p>Rives, A. et al. Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences. Proc. Natl Acad. Sci. USA 118, e2016239118 (2021).</p>
</li>
<li>
<p>Elnaggar, A. et al. ProtTrans: towards cracking the language of life’s code through self-supervised deep learning and high performance computing. IEEE Trans. Pattern Anal. Mach. Intell. 44, 7112-7127 (2022).</p>
</li>
<li>
<p>Littmann, M., Heinzinger, M., Dallago, C., Olenyi, T. &amp; Rost, B. Embeddings from deep learning transfer go annotations beyond homology. Sci. Rep. 11, 1-14 (2021).</p>
</li>
<li>
<p>Marquet, C. et al. Embeddings from protein language models predict conservation and variant effects. Hum. Genet. 141, 1629-1647 (2022).</p>
</li>
<li>
<p>Littmann, M., Heinzinger, M., Dallago, C., Weissenow, K. &amp; Rost, B. Protein embeddings and deep learning predict binding residues for various ligand classes. Sci. Rep. 11, 23916 (2021).</p>
</li>
<li>
<p>Avsec, Ž. et al. Base-resolution models of transcription-factor binding reveal soft motif syntax. Nat. Genet. 53, 354-366 (2021).</p>
</li>
<li>
<p>Zhou, J. &amp; Troyanskaya, O. G. Predicting effects of noncoding variants with deep learning-based sequence model. Nat. Methods 12, 931-934 (2015).</p>
</li>
<li>
<p>Mateo, L. J., Sinnott-Armstrong, N. &amp; Boettiger, A. N. Tracing dna paths and rna profiles in cultured cells and tissues with orca. Nat. Protoc. 16, 1647-1713 (2021).</p>
</li>
<li>
<p>de Almeida, B. P., Reiter, F., Pagani, M. &amp; Stark, A. DeepSTARR predicts enhancer activity from dna sequence and enables the de novo design of synthetic enhancers. Nat. Genet. 54, 613-624 (2022).</p>
</li>
<li>
<p>Eraslan, G., Avsec, Ž., Gagneur, J. &amp; Theis, F. J. Deep learning: new computational modelling techniques for genomics. Nat. Rev. Genet. 20, 389-403 (2019).</p>
</li>
<li>
<p>Zhou, J. et al. Deep learning sequence-based ab initio prediction of variant effects on expression and disease risk. Nat. Genet. 50, 1171-1179 (2018).</p>
</li>
<li>
<p>Kelley, D. R. Cross-species regulatory sequence activity prediction. PLOS Comput. Biol. 16, e1008050 (2020).</p>
</li>
<li>
<p>Kelley, D. R. et al. Sequential regulatory activity prediction across chromosomes with convolutional neural networks. Genome Res. 28, 739-750 (2018).</p>
</li>
<li>
<p>Agarwal, V. &amp; Shendure, J. Predicting mRNA abundance directly from genomic sequence using deep convolutional neural networks. Cell Rep. 31, 107663 (2020).</p>
</li>
<li>
<p>Chen, K. M., Wong, A. K., Troyanskaya, O. G. &amp; Zhou, J. A sequence-based global map of regulatory activity for deciphering human genetics. Nat. Genet. 54, 940-949 (2022).</p>
</li>
<li>
<p>Avsec, Ž. et al. Effective gene expression prediction from sequence by integrating long-range interactions. Nat. Methods 18, 1196-1203 (2021).</p>
</li>
<li>
<p>Ji, Y., Zhou, Z., Liu, H. &amp; Davuluri, R. V. Dnabert: pre-trained bidirectional encoder representations from transformers model for DNA-language in genome. Bioinformatics 37, 2112-2120 (2021).</p>
</li>
<li>
<p>Zvyagin, M. T. et al. Genslms: genome-scale language models reveal SARS-CoV-2 evolutionary dynamics. Preprint at bioRXiv <a target="_blank" rel="noopener" href="https://doi.org/10.1101/2022.10.10.511571">https://doi.org/10.1101/2022.10.10.511571</a> (2022).</p>
</li>
<li>
<p>Oute, J. C. &amp; Deane, C. M. Protein language embeddings provide strong signals for protein engineering. Nat. Mach. Intell. 6, 170-179 (2024).</p>
</li>
<li>
<p>Zhou, Z. et al. Dnabert-2: efficient foundation model and benchmark for multi-species genome. in Proceedings of the Twelfth International Conference on Learning Representations <a target="_blank" rel="noopener" href="https://openreview.net/pdf?id=oMLQB4EZE1">https://openreview.net/pdf?id=oMLQB4EZE1</a> (ICLR, 2024).</p>
</li>
<li>
<p>Fishman, V. et al. Gena-lm: A family of open-source foundational models for long dna sequences. Preprint at bioRXiv <a target="_blank" rel="noopener" href="https://doi.org/10.1101/2023.06.12.544594">https://doi.org/10.1101/2023.06.12.544594</a> (2023).</p>
</li>
<li>
<p>Nguyen, E. et al. Hyenadna: Long-range genomic sequence modeling at single nucleotide resolution. in 37th Conference on Neural Information Processing Systems <a target="_blank" rel="noopener" href="https://openreview.net/pdf?id=ubzNoJjOKj">https://openreview.net/pdf?id=ubzNoJjOKj</a> (NeurIPS, 2023).</p>
</li>
<li>
<p>Mendoza-Revilla, J. et al. A foundational large language model for edible plant genomes. Commun. Biol. 7, 835 (2024).</p>
</li>
<li>
<p>Rae, J. W. et al. Scaling language models: methods, analysis &amp; insights from training gopher. Preprint at <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2112.11446">https://arxiv.org/abs/2112.11446</a> (2021).</p>
</li>
<li>
<p>Consortium, G. P. et al. A global reference for human genetic variation. Nature 526, 68 (2015).</p>
</li>
<li>
<p>Harrow, J. et al. GENCODE: the reference human genome annotation for the encode project. Genome Res. 22, 1760-1774 (2012).</p>
</li>
<li>
<p>Meylan, P., Dreos, R., Ambrosini, G., Groux, R. &amp; Bucher, P. Epd in 2020: enhanced data visualization and extension to ncRNA promoters. Nucleic Acids Res. 48, D65-D69 (2020).</p>
</li>
<li>
<p>ENCODE. An integrated encyclopedia of dna elements in the human genome. Nature 489, 57-74 (2012).</p>
</li>
<li>
<p>The ENCODE Project Consortium. Expanded encyclopaedias of dna elements in the human and mouse genomes. Nature 583, 699-710 (2020).</p>
</li>
<li>
<p>Meuleman, W. et al. Index and biological spectrum of human DNase I hypersensitive sites. Nature 584, 244-251 (2020).</p>
</li>
<li>
<p>Li, F.-Z., Amini, A. P., Yang, K. K. &amp; Lu, A. X. Pretrained protein language model transfer learning: is the final layer representation what we want? in Machine Learning for Structural Biology Workshop (NeurIPS, 2022).</p>
</li>
<li>
<p>Liu, H. et al. Few-shot parameter-efficient fine-tuning is better and cheaper than in-context learning. in 36th Conference on Neural Information Processing Systems (NeurIPS, 2022).</p>
</li>
<li>
<p>Jaganathan, K. et al. Predicting splicing from primary sequence with deep learning. Cell 176, 535-548 (2019).</p>
</li>
<li>
<p>Benegas, G., Batra, S. S. &amp; Song, Y. S. DNA language models are powerful zero-shot predictors of non-coding variant effects. Proc. Natl Acad. Sci. USA 120, e2311219120 (2023).</p>
</li>
<li>
<p>Vig, J. et al. BERTology meets biology: Interpreting attention in protein language models. in Proceedings of the International Conference on Learning Representations 2021 <a target="_blank" rel="noopener" href="https://openreview.net/pdf?id=YWtLZvLmud7">https://openreview.net/pdf?id=YWtLZvLmud7</a> (ICLR, 2021).</p>
</li>
<li>
<p>Braun, S. et al. Decoding a cancer-relevant splicing decision in the ron proto-oncogene using high-throughput mutagenesis. Nat. Commun. 9, 3315 (2018).</p>
</li>
<li>
<p>McLaren, W. et al. The Ensembl variant effect predictor. Genome Biol. 17, 1-14 (2016).</p>
</li>
<li>
<p>Lappalainen, T. et al. Transcriptome and genome sequencing uncovers functional variation in humans. Nature 501, 506-511 (2013).</p>
</li>
<li>
<p>Consortium, G. The gtex consortium atlas of genetic regulatory effects across human tissues. Science 369, 1318-1330 (2020).</p>
</li>
<li>
<p>Võsa, U. et al. Large-scale cis-and trans-eqtl analyses identify thousands of genetic loci and polygenic scores that regulate blood gene expression. Nat. Genetics 53, 1300-1310 (2021).</p>
</li>
<li>
<p>Chowdhery, A. et al. PaLM: scaling language modeling with pathways. J. Mach. Learn. Technol. 24, 11324-11436 (2021).</p>
</li>
<li>
<p>Hoffmann, J. et al. Training compute-optimal large language models. in 36th Conference on Neural Information Processing Systems <a target="_blank" rel="noopener" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/c1e2faff6f58887093f114ebe04a3e5-Paper-Conference.pdf">https://proceedings.neurips.cc/paper_files/paper/2022/file/c1e2faff6f58887093f114ebe04a3e5-Paper-Conference.pdf</a> (NeurIPS, 2022).</p>
</li>
<li>
<p>Rogers, A., Kovaleva, O. &amp; Rumshisky, A. A primer in BERTology: what we know about how bert works. Trans. Assoc. Comput. Linguist. 8, 842-866 (2020).</p>
</li>
<li>
<p>Stärk, H., Dallago, C., Heinzinger, M. &amp; Rost, B. Light attention predicts protein location from the language of life. Bioinform. Adv. 1, vbab035 (2021).</p>
</li>
<li>
<p>Zou, J. et al. A primer on deep learning in genomics. Nat. Genetics 51, 12-18 (2019).</p>
</li>
<li>
<p>Wang, A. et al. Superglue: a stickier benchmark for general-purpose language understanding systems. in 33rd Conference on Neural Information Processing Systems <a target="_blank" rel="noopener" href="https://papers.nips.cc/paper_files/paper/2019/file/4496bf24afe7fab6f046bf4923da8de6-Paper.pdf">https://papers.nips.cc/paper_files/paper/2019/file/4496bf24afe7fab6f046bf4923da8de6-Paper.pdf</a> (NeurIPS, 2019).</p>
</li>
<li>
<p>Hendrycks, D. &amp; Gimpel, K. Gaussian error linear units (gelus). Preprint at <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1606.08415">https://arxiv.org/abs/1606.08415</a> (2016).</p>
</li>
<li>
<p>Su, J. et al. Roformer: enhanced transformer with rotary position embedding. Neurocomputing 568, 127063 (2024).</p>
</li>
<li>
<p>Kingma, D. P. &amp; Ba, J. Adam: a method for stochastic optimization. Preprint at <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1412.6980v5">https://arxiv.org/abs/1412.6980v5</a> (2015).</p>
</li>
<li>
<p>Pedregosa, F. et al. Scikit-learn: machine learning in Python. J. Mach. Learn. Res. 12, 2825-2830 (2011).</p>
</li>
<li>
<p>Bergstra, J., Bardenet, R., Bengio, Y. &amp; Kégl, B. Algorithms for hyper-parameter optimization. in Advances in Neural Information Processing Systems 24 <a target="_blank" rel="noopener" href="https://papers.nips.cc/paper_files/paper/2011/file/86e8f7ab32cfd12577bc2619bc635690-Paper.pdf">https://papers.nips.cc/paper_files/paper/2011/file/86e8f7ab32cfd12577bc2619bc635690-Paper.pdf</a> (NeurIPS, 2011).</p>
</li>
<li>
<p>Byrska-Bishop, M. et al. High-coverage whole-genome sequencing of the expanded 1000 genomes project cohort including 602 trios. Cell 185, 3426-3440 (2022).</p>
</li>
<li>
<p>Kim, D., Paggi, J. M., Park, C., Bennett, C. &amp; Salzberg, S. L. Graph-based genome alignment and genotyping with hisat2 and hisat-genotype. Nat. Biotechnol. 37, 907-905 (2019).</p>
</li>
<li>
<p>Leslie, R., O’Donnell, C. J. &amp; Johnson, A. D. GRASP: analysis of genotype-phenotype results from 1390 genome-wide association studies and corresponding open access database. Bioinformatics 30, i185-i194 (2014).</p>
</li>
<li>
<p>Landrum, M. J. et al. Clinvar: improving access to variant interpretations and supporting evidence. Nucleic Acids Res. 46, D1062-D1067 (2018).</p>
</li>
<li>
<p>Stenson, P. D. et al. The Human Gene Mutation Database (HGMD®): optimizing its use in a clinical diagnostic or research setting. Hum. Genet. 139, 1197-1207 (2020).</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <blockquote class="article-copyright">
    <p><strong>本文作者：</strong>LuoYing @ 小小白的笔记屋</p>
    <p><strong>本文链接：</strong><a href="https://luoying.netlify.app/2024/11/17/4x6a3fgp/">https://luoying.netlify.app/2024/11/17/4x6a3fgp/</a></p>
    <p><strong>本文标题：</strong>Nucleotide-Transformer：构建和评估人类基因组学的稳健基础模型</p>
    
    
    <p><strong>本文版权：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><span class="icon-creative-commons"></span>BY-NC-SA</a> 许可协议。转载请注明出处！</p>
    <span class="icon-creative-commons article-copyright-bg"></span>
  </blockquote>
      
      
      
      
      
      
      
      

    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/covers/文件25.jpg" data-sizes="auto" alt="最强AI+最强Prompt=？！！" class="lazyload">
          
        
        <a href="/2024/11/22/5ihfxsje/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            最强AI+最强Prompt=？！！
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/covers/文件13.jpg" data-sizes="auto" alt="微信自动化工具v1.0，它来啦！" class="lazyload">
        
      
      <a href="/2024/11/16/rcvb4vct/"></a>
      <div class="article-nav-caption">后一篇</div>
      <h3 class="article-nav-title">
        
          微信自动化工具v1.0，它来啦！
        
      </h3>
    </div>
    
  </nav>


</article>






</section>
          
        </div>
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep rotate"></span>
      LuoYing
    </div>
    
      <div>
        基于&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        285.3k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        18:26
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5"><span class="toc-number">1.</span> <span class="toc-text"> 文章链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text"> 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">3.</span> <span class="toc-text"> 摘要</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E6%96%B0%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text"> 创新点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9"><span class="toc-number">5.</span> <span class="toc-text"> 主要内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%89%8D%E9%A1%BB%E7%9F%A5"><span class="toc-number">5.1.</span> <span class="toc-text"> 读前须知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">5.2.</span> <span class="toc-text"> 引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">5.3.</span> <span class="toc-text"> 结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nucleotide-transformer%E6%A8%A1%E5%9E%8B%E5%87%86%E7%A1%AE%E9%A2%84%E6%B5%8B%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.3.1.</span> <span class="toc-text"> Nucleotide Transformer模型准确预测基因组学任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95"><span class="toc-number">5.3.2.</span> <span class="toc-text"> 基因组学基础模型的基准测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E6%97%A0%E7%9B%91%E7%9D%A3%E7%9A%84%E6%96%B9%E5%BC%8F%E6%A3%80%E6%B5%8B%E5%B7%B2%E7%9F%A5%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%83%E4%BB%B6"><span class="toc-number">5.3.3.</span> <span class="toc-text"> 以无监督的方式检测已知的基因组元件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E8%AE%AD%E7%BB%83%E7%9A%84%E5%B5%8C%E5%85%A5%E9%A2%84%E6%B5%8B%E7%AA%81%E5%8F%98%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">5.3.4.</span> <span class="toc-text"> 预训练的嵌入预测突变的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E4%B8%AD%E6%88%90%E6%9C%AC%E6%95%88%E7%9B%8A%E9%A2%84%E6%B5%8B%E7%9A%84%E6%A8%A1%E5%9E%8B%E4%BC%98%E5%8C%96"><span class="toc-number">5.3.5.</span> <span class="toc-text"> 基因组学中成本效益预测的模型优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A8%E8%AE%BA"><span class="toc-number">5.4.</span> <span class="toc-text"> 讨论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">5.5.</span> <span class="toc-text"> 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.5.1.</span> <span class="toc-text"> 模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">5.5.1.1.</span> <span class="toc-text"> 架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83"><span class="toc-number">5.5.1.2.</span> <span class="toc-text"> 训练</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B"><span class="toc-number">5.5.1.3.</span> <span class="toc-text"> 探测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83"><span class="toc-number">5.5.1.4.</span> <span class="toc-text"> 微调</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E7%9B%91%E7%9D%A3bpnet%E5%9F%BA%E7%BA%BF%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">5.5.1.5.</span> <span class="toc-text"> 与监督BPNet基线的比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E5%B7%B2%E5%8F%91%E5%B8%83%E7%9A%84%E9%A2%84%E8%AE%AD%E7%BB%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">5.5.1.6.</span> <span class="toc-text"> 与已发布的预训练基因组学模型的比较</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.</span> <span class="toc-text"> 预训练数据集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%BA%E7%B1%BB%E5%8F%82%E8%80%83%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.1.</span> <span class="toc-text"> 人类参考基因组数据集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%83%E4%BA%BA%E5%9F%BA%E5%9B%A0%E7%BB%841000g%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.2.</span> <span class="toc-text"> 千人基因组(1000G)数据集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E7%89%A9%E7%A7%8D%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.5.2.3.</span> <span class="toc-text"> 多物种数据集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">5.5.3.</span> <span class="toc-text"> 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E8%AE%BE%E6%96%BD"><span class="toc-number">5.5.3.1.</span> <span class="toc-text"> 硬件设施</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nucleotide-transformer%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.5.4.</span> <span class="toc-text"> Nucleotide Transformer下游任务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E8%A7%82%E9%81%97%E4%BC%A0%E6%A0%87%E8%AE%B0%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.1.</span> <span class="toc-text"> 表观遗传标记预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%AD%90%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.2.</span> <span class="toc-text"> 启动子序列预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA%E5%AD%90%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.3.</span> <span class="toc-text"> 增强子序列预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%AA%E6%8E%A5%E4%BD%8D%E7%82%B9%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.4.4.</span> <span class="toc-text"> 剪接位点预测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E5%89%B2%E5%92%8C%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0"><span class="toc-number">5.5.5.</span> <span class="toc-text"> 数据集分割和性能评估</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.5.6.</span> <span class="toc-text"> 其他下游任务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%93%E8%89%B2%E8%B4%A8%E8%B0%B1%E7%B3%BB%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.6.1.</span> <span class="toc-text"> 染色质谱系预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spliceai%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95"><span class="toc-number">5.5.6.2.</span> <span class="toc-text"> SpliceAI基准测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA%E5%AD%90%E6%B4%BB%E6%80%A7%E9%A2%84%E6%B5%8B"><span class="toc-number">5.5.6.3.</span> <span class="toc-text"> 增强子活性预测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">5.5.7.</span> <span class="toc-text"> 其他性能分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#t-sne%E5%B5%8C%E5%85%A5%E6%8A%95%E5%BD%B1"><span class="toc-number">5.5.7.1.</span> <span class="toc-text"> t-SNE嵌入投影</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E6%9E%84%E5%87%86%E7%A1%AE%E7%8E%87%E5%92%8C%E5%A4%8D%E6%9D%82%E5%BA%A6perplexity"><span class="toc-number">5.5.7.2.</span> <span class="toc-text"> 重构准确率和复杂度（perplexity）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%83%E7%B4%A0%E4%B8%AD%E7%9A%84%E6%A0%87%E8%AE%B0%E9%87%8D%E6%9E%84"><span class="toc-number">5.5.7.3.</span> <span class="toc-text"> 不同基因组元素中的标记重构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%8F%98%E5%BC%82%E4%BC%98%E5%85%88%E7%BA%A7%E6%8E%92%E5%BA%8F"><span class="toc-number">5.5.7.4.</span> <span class="toc-text"> 功能变异优先级排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%8A%9B%E5%9B%BE%E5%88%86%E6%9E%90"><span class="toc-number">5.5.7.5.</span> <span class="toc-text"> 注意力图分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E6%B5%8Bdeepstarr%E6%95%B0%E6%8D%AE%E4%B8%AD%E9%87%8D%E8%A6%81%E7%9A%84tf%E5%9F%BA%E5%BA%8F%E5%AE%9E%E4%BE%8B"><span class="toc-number">5.5.7.6.</span> <span class="toc-text"> 预测DeepSTARR数据中重要的TF基序实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">5.5.8.</span> <span class="toc-text"> 数据可用性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">5.5.9.</span> <span class="toc-text"> 代码可用性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E4%BF%A1%E6%81%AF"><span class="toc-number">6.</span> <span class="toc-text"> 补充信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">7.</span> <span class="toc-text"> 参考文献</span></a></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="LuoYing" class="lazyload">
  <div class="sidebar-author-name">LuoYing</div>
  <div class="sidebar-description">一方小筑，与君共勉</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">119</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">15</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">2</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png"/>
        </div>
      </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>



  
<script src="/js/generator_search.js" defer></script>






  
<script src="https://npm.webcache.cn/mouse-firework@0.0.6/dist/index.umd.js" integrity="sha384-vkGvf25gm1C1PbcoD5dNfc137HzNL&#x2F;hr1RKA5HniJOaawtvUmH5lTVFgFAruE9Ge" crossorigin="anonymous"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>








<div id="lazy-script">
  <div>
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      








    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.1.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  

<script data-pjax>
  var updateTime = _$('#post-update-time')?.innerHTML;

  if (updateTime) {
    const update = new Date(updateTime);
    const now = new Date();
    const diff = now - update;
    const days = diff / 86400000;
    const { daysAgo, message: template } = window.REIMU_CONFIG.outdate;
    if (days >= daysAgo) {
      const message = template.replace(/{time}/, updateTime);
      const blockquote = _$('#outdate-blockquote');
      if (blockquote) {
        blockquote.querySelector('p').innerText = message;
        blockquote.style.display = 'block';
      }
    }
  }
</script>


  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>



  


  </body>
  </html>

